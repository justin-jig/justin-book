---
title: "Spring Boot & WebFlux ë¹„ë™ê¸° ì„œë¹„ìŠ¤ (Asynchronous Service in Spring Boot & WebFlux)"
date: 2025-10-26
---

#### ìš”ì•½

- **Spring Boot**ëŠ” `@Async` ê¸°ë°˜ì˜ **ìŠ¤ë ˆë“œí’€(Thread Pool)** ëª¨ë¸ê³¼  
  **Spring WebFlux** ê¸°ë°˜ì˜ **ë¦¬ì•¡í‹°ë¸Œ(Non-blocking Reactive)** ëª¨ë¸,  
  ë‘ ê°€ì§€ ë°©ì‹ìœ¼ë¡œ **ë¹„ë™ê¸° ì²˜ë¦¬(Asynchronous Processing)** ë¥¼ ì§€ì›í•œë‹¤.  
- ì£¼ìš” êµ¬ì„±:
  1. `@Async` / `CompletableFuture` â€” ìŠ¤ë ˆë“œí’€ ê¸°ë°˜ ë¹„ë™ê¸° ì‹¤í–‰
  2. `TaskExecutor` â€” ì‹¤í–‰ ìŠ¤ë ˆë“œí’€ ê´€ë¦¬
  3. `WebFlux (Reactor)` â€” ë…¼ë¸”ë¡œí‚¹ ë¦¬ì•¡í‹°ë¸Œ ìŠ¤íŠ¸ë¦¼ ê¸°ë°˜ ë¹„ë™ê¸° ì²˜ë¦¬
  4. `Mono` / `Flux` â€” ë‹¨ì¼Â·ë‹¤ì¤‘ ë¹„ë™ê¸° ë°ì´í„° ìŠ¤íŠ¸ë¦¼
  5. `Schedulers` â€” ì‹¤í–‰ ìŠ¤ì¼€ì¤„ëŸ¬ ì œì–´ (I/O, Parallel, Single ë“±)
   
- ì„ íƒ ê¸°ì¤€:
  - **@Async** â†’ ë‹¨ìˆœ ë¹„ë™ê¸° ì‘ì—… (I/OÂ·ë©”ì¼Â·íŒŒì¼ ë“±)
  - **WebFlux** â†’ ëŒ€ê·œëª¨ ìš”ì²­ ì²˜ë¦¬, ê³ ì„±ëŠ¥ REST API, ë…¼ë¸”ë¡œí‚¹ ì„œë²„

> Spring BootëŠ” ë‘ ê°€ì§€ ë¹„ë™ê¸° íŒ¨ëŸ¬ë‹¤ì„ì„ ì œê³µí•œë‹¤:
>
> * **@Async** â†’ ìŠ¤ë ˆë“œí’€ ê¸°ë°˜, ë‹¨ìˆœ ë¹„ë™ê¸° ì‹¤í–‰ì— ì í•©
> * **WebFlux** â†’ ë…¼ë¸”ë¡œí‚¹, ëŒ€ê·œëª¨ íŠ¸ë˜í”½ ì²˜ë¦¬ì— ìµœì í™”
>
> ìƒí™©ì— ë§ê²Œ ë‘ ë°©ì‹ì„ ë³‘í–‰í•˜ë©´,
> **ì•ˆì •ì„±ê³¼ í™•ì¥ì„±ì„ ëª¨ë‘ í™•ë³´í•œ ê³ ì„±ëŠ¥ ë°±ì—”ë“œ ì‹œìŠ¤í…œ**ì„ ì„¤ê³„í•  ìˆ˜ ìˆë‹¤. 
> Spring BootëŠ” â€œThread Pool ê¸°ë°˜ ì„ ì–¸í˜• ë¹„ë™ê¸°(@Async)â€ì™€  
> â€œReactor ê¸°ë°˜ ë¦¬ì•¡í‹°ë¸Œ ìŠ¤íŠ¸ë¦¼(WebFlux)â€ì„ ëª¨ë‘ ì œê³µí•œë‹¤.  
> í”„ë¡œì íŠ¸ ê·œëª¨Â·íŠ¹ì„±ì— ë”°ë¼ ë‘ ë°©ì‹ì„ **í˜¼í•© ì‚¬ìš©**í•  ìˆ˜ ìˆë‹¤.

---

##### ì°¸ê³ ìë£Œ

- [Spring Framework - Asynchronous Execution](https://docs.spring.io/spring-framework/reference/integration/scheduling.html#scheduling-annotation-support-async)
- [Spring WebFlux ê³µì‹ ë¬¸ì„œ](https://docs.spring.io/spring-framework/reference/web/webflux.html)
- [Project Reactor Docs](https://projectreactor.io/docs/core/release/reference/)

---

#### 1. ë¹„ë™ê¸° ì²˜ë¦¬ ëª¨ë¸ ë¹„êµ

| í•­ëª© | @Async ëª¨ë¸ | WebFlux ëª¨ë¸ |
|------|--------------|---------------|
| ì‹¤í–‰ êµ¬ì¡° | Thread Pool ê¸°ë°˜ | Reactor ì´ë²¤íŠ¸ ë£¨í”„ ê¸°ë°˜ |
| í”„ë¡œê·¸ë˜ë° ìŠ¤íƒ€ì¼ | ëª…ë ¹í˜• (Imperative) | ì„ ì–¸í˜• (Reactive) |
| ë°ì´í„° íƒ€ì… | Future / CompletableFuture | Mono / Flux |
| ìŠ¤ë ˆë“œ ê´€ë¦¬ | TaskExecutor ì§ì ‘ ê´€ë¦¬ | ìë™ (Event Loop + Scheduler) |
| ì‚¬ìš© ì˜ˆ | I/O, DB, ë©”ì¼, ìŠ¤ì¼€ì¤„ëŸ¬ | REST API, SSE, WebSocket |
| ì¥ì  | ì„¤ì • ë‹¨ìˆœ, ìµìˆ™í•œ íŒ¨í„´ | ê³ ì„±ëŠ¥, ë…¼ë¸”ë¡œí‚¹, í™•ì¥ì„± ë†’ìŒ |
| ë‹¨ì  | ìŠ¤ë ˆë“œí’€ ì˜¤ë²„í—¤ë“œ | ëŸ¬ë‹ ì»¤ë¸Œ, ë””ë²„ê¹… ì–´ë ¤ì›€ |

---

#### 2. @Async ê¸°ë°˜ ë¹„ë™ê¸° ì²˜ë¦¬ (Thread Pool ë°©ì‹)

```java
@Configuration
@EnableAsync
public class AsyncConfig {

    @Bean(name = "taskExecutor")
    public Executor taskExecutor() {
        ThreadPoolTaskExecutor executor = new ThreadPoolTaskExecutor();
        executor.setCorePoolSize(5);
        executor.setMaxPoolSize(10);
        executor.setQueueCapacity(100);
        executor.setThreadNamePrefix("Async-Thread-");
        executor.initialize();
        return executor;
    }
}
```

```java
@Service
public class NotificationService {

    @Async("taskExecutor")
    public CompletableFuture<String> sendMail(String email) {
        try {
            Thread.sleep(2000);
            return CompletableFuture.completedFuture("Mail sent to " + email);
        } catch (InterruptedException e) {
            Thread.currentThread().interrupt();
            return CompletableFuture.failedFuture(e);
        }
    }
}
```

```java
@RestController
@RequiredArgsConstructor
public class MailController {

    private final NotificationService notificationService;

    @PostMapping("/mail")
    public CompletableFuture<ResponseEntity<String>> sendMail(@RequestParam String to) {
        return notificationService.sendMail(to)
                .thenApply(ResponseEntity::ok);
    }
}
```

> ğŸ’¡ `CompletableFuture`ëŠ” Spring MVCì™€ ê²°í•© ì‹œ **Servlet ë¹„ë™ê¸° ì‘ë‹µ(async response)** ìœ¼ë¡œ ë™ì‘í•œë‹¤.
> ë©”ì¸ ì“°ë ˆë“œë¥¼ ì°¨ë‹¨í•˜ì§€ ì•Šê³ , ì‘ë‹µì„ ë³„ë„ ì“°ë ˆë“œì—ì„œ ì²˜ë¦¬ ê°€ëŠ¥í•˜ë‹¤.

---

#### 3. Spring WebFlux â€” ë¦¬ì•¡í‹°ë¸Œ ë…¼ë¸”ë¡œí‚¹ êµ¬ì¡°

WebFluxëŠ” **Servlet ëŒ€ì‹  Reactor Netty ê¸°ë°˜ ë…¼ë¸”ë¡œí‚¹ ì„œë²„**ë¥¼ ì‚¬ìš©í•œë‹¤.
ë‚´ë¶€ì ìœ¼ë¡œ **ì´ë²¤íŠ¸ ë£¨í”„(Event Loop)** ê¸°ë°˜ìœ¼ë¡œ ë™ì‘í•˜ë©°,
ìš”ì²­ë‹¹ ìŠ¤ë ˆë“œ ìƒì„± ì—†ì´ **Mono/Flux ìŠ¤íŠ¸ë¦¼ìœ¼ë¡œ ë°ì´í„°ë¥¼ íë¦„ ê¸°ë°˜ìœ¼ë¡œ ì²˜ë¦¬**í•œë‹¤.

```java
@RestController
@RequestMapping("/reactive")
public class ReactiveController {

    private final WebClient webClient = WebClient.create("https://jsonplaceholder.typicode.com");

    @GetMapping("/users")
    public Flux<UserDto> getUsers() {
        return webClient.get()
                .uri("/users")
                .retrieve()
                .bodyToFlux(UserDto.class)
                .timeout(Duration.ofSeconds(5))
                .onErrorResume(e -> Flux.empty());
    }

    @GetMapping("/user/{id}")
    public Mono<UserDto> getUser(@PathVariable Long id) {
        return webClient.get()
                .uri("/users/{id}", id)
                .retrieve()
                .bodyToMono(UserDto.class)
                .doOnNext(u -> System.out.println("Fetched user: " + u.getName()));
    }
}
```

| ë°˜í™˜ íƒ€ì…             | ì„¤ëª…                               |
| ----------------- | -------------------------------- |
| **Mono<T>**       | ë‹¨ì¼ ê²°ê³¼ (0~1ê°œ)                     |
| **Flux<T>**       | ë‹¤ì¤‘ ê²°ê³¼ (Nê°œ ìŠ¤íŠ¸ë¦¼)                   |
| **WebClient**     | ë¹„ë™ê¸° HTTP í´ë¼ì´ì–¸íŠ¸ (RestTemplate ëŒ€ì²´) |
| **onErrorResume** | ì˜¤ë¥˜ ë°œìƒ ì‹œ ëŒ€ì²´ íë¦„ ì •ì˜                 |

> âš™ï¸ **íŠ¹ì§•:**
>
> * ìš”ì²­ë§ˆë‹¤ ìŠ¤ë ˆë“œë¥¼ ìƒì„±í•˜ì§€ ì•Šê³  **Event Loop (Reactor)** ê°€ ëª¨ë“  ìš”ì²­ ì²˜ë¦¬
> * **ëŒ€ëŸ‰ ì—°ê²° ì²˜ë¦¬ ì‹œ ë©”ëª¨ë¦¬ íš¨ìœ¨ ê·¹ëŒ€í™”**
> * REST API, WebSocket, SSE, Streaming ì‘ë‹µì— ì í•©

---

#### 4. WebFlux Service ê³„ì¸µ ë¹„ë™ê¸° ì˜ˆì‹œ

```java
@Service
public class ReactiveUserService {

    private final WebClient webClient = WebClient.create("https://api.example.com");

    public Flux<UserDto> getActiveUsers() {
        return webClient.get()
                .uri("/users")
                .retrieve()
                .bodyToFlux(UserDto.class)
                .filter(UserDto::isActive)
                .subscribeOn(Schedulers.boundedElastic());
    }
}
```

> ğŸ’¡ **Schedulers ì¢…ë¥˜**
>
> | Scheduler          | ì„¤ëª…                   |
> | ------------------ | -------------------- |
> | `parallel()`       | CPU-bound ì‘ì—…ìš©        |
> | `boundedElastic()` | I/O-bound (íŒŒì¼, DB ë“±) |
> | `single()`         | ë‹¨ì¼ ìŠ¤ë ˆë“œ ì‹¤í–‰            |
> | `immediate()`      | í˜„ì¬ ìŠ¤ë ˆë“œ ì‹¤í–‰            |

---

#### 5. WebFluxì—ì„œì˜ ë³‘ë ¬ ì²˜ë¦¬

```java
public Flux<UserDetail> mergeUserData() {
    Mono<List<User>> users = getUserList().collectList();
    Mono<List<Order>> orders = getOrderList().collectList();

    return Mono.zip(users, orders)
        .flatMapMany(tuple -> Flux.fromIterable(merge(tuple.getT1(), tuple.getT2())));
}
```

> âœ… `Mono.zip()`ì€ ì—¬ëŸ¬ ë¹„ë™ê¸° ë°ì´í„° ì†ŒìŠ¤ë¥¼ **ë™ì‹œì— ìš”ì²­í•˜ê³  ê²°í•©**í•  ìˆ˜ ìˆë‹¤.
> ë³‘ë ¬ ë°ì´í„° ìˆ˜ì§‘ ì‹œ ë§¤ìš° ìœ ìš©í•˜ë‹¤.

---

#### 6. ë¹„ë™ê¸° ì˜ˆì™¸ ì²˜ë¦¬

```java
@RestControllerAdvice
public class GlobalExceptionHandler {

    @ExceptionHandler(Exception.class)
    public ResponseEntity<String> handle(Exception e) {
        return ResponseEntity.status(HttpStatus.INTERNAL_SERVER_ERROR)
                .body("âŒ Error: " + e.getMessage());
    }
}
```

> âš™ï¸ `onErrorResume`, `onErrorReturn`, `doOnError` ë“±ì„ ì¡°í•©í•˜ë©´
> **WebFlux ìŠ¤íŠ¸ë¦¼ ë‚´ë¶€ ì˜ˆì™¸ ì²˜ë¦¬ë„ ì„ ì–¸ì ìœ¼ë¡œ ì œì–´**í•  ìˆ˜ ìˆë‹¤.

---

#### 7. ìš´ì˜ ë° ì„±ëŠ¥ íŒ

| í•­ëª©               | ê¶Œì¥ ì„¤ì • / ì„¤ëª…                        |
| ---------------- | --------------------------------- |
| **Thread Pool**  | CPU ì½”ì–´ Ã— 2 + 1                    |
| **Scheduler ì„ íƒ** | I/O ì‘ì—…ì€ `boundedElastic()`        |
| **Timeout ì²˜ë¦¬**   | `.timeout(Duration.ofSeconds(n))` |
| **ëª¨ë‹ˆí„°ë§**         | Micrometer + Reactor Metrics      |
| **ë””ë²„ê¹…**          | `Hooks.onOperatorDebug()` í™œì„±í™”     |
| **í…ŒìŠ¤íŠ¸**          | `StepVerifier` (Reactor Test) ì‚¬ìš©  |

---
