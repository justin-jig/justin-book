---
title: "Redis 기본 구조 및 설정 (Redis Fundamentals)"
date: 2025-10-25
---

#### 요약

- Redis는 **메모리 기반 Key-Value 저장소**로,  
  캐시·세션·Pub/Sub·Lock 등 다양한 용도로 사용된다.  
- 캐시의 핵심: TTL, Eviction Policy, Persistence(AOF/RDB)  
- 언어별 기본 연결 및 헬스체크 예시 포함.

##### 운영 체크리스트

* [ ] Redis Ping / 연결 지연 모니터링
* [ ] Key TTL 관리 (과도한 Stale 방지)
* [ ] maxmemory-policy 명시
* [ ] 모니터링 도구 (RedisInsight, Grafana) 연동
* [ ] Sentinel / Cluster Failover 구성

---

##### 참고자료
- [Redis Data Types](https://redis.io/docs/latest/develop/data-types/)
- [Redis Persistence](https://redis.io/docs/latest/operate/oss_and_stack/management/persistence/)
- [Redis Eviction Policies](https://redis.io/docs/latest/develop/reference/eviction/)
- [Redis Python Client](https://pypi.org/project/aioredis/)
- [Redis Java Template](https://docs.spring.io/spring-data/redis/docs/current/reference/html/#redis:template)
- [node-redis](https://www.npmjs.com/package/redis)

---

#### 1. Redis 기본 개념

| 항목 | 설명 |
|------|------|
| **Key** | 문자열 기반의 고유 식별자 |
| **Value** | String, Hash, List, Set, ZSet 등 다양한 타입 |
| **TTL (Time To Live)** | 만료 시간(sec) — `SETEX`, `EXPIRE` |
| **Eviction Policy** | LRU, LFU, TTL 기반 메모리 제거 정책 |
| **Persistence** | RDB 스냅샷, AOF 로그 방식 |

- **Key**: 데이터를 식별하는 고유 문자열  
- **Value**: 저장되는 실제 데이터 (문자열, 리스트 등)  
- **TTL**: 데이터의 유효 시간 (초 단위)  
- **Eviction Policy**: 메모리 초과 시 제거 방식  
- **Persistence**: 데이터를 디스크에 저장하는 방식  
- **String**: 단일 문자열 값  
- **Hash**: 필드-값 쌍의 집합  
- **List**: 순서 있는 문자열 목록  
- **Set**: 중복 없는 집합  
- **ZSet**: 점수 기반으로 정렬된 집합  
- **LRU**: 가장 오래 사용되지 않은 데이터 제거  
- **LFU**: 가장 적게 사용된 데이터 제거  
- **RDB**: 주기적 전체 스냅샷 저장  
- **AOF**: 모든 쓰기 작업을 로그로 저장  

- **SETEX**: **데이터의 유효 기간을 설정** Key를 설정하면서 동시에 TTL(만료 시간)을 지정  
  예: `SETEX session:123 3600 "user data"` → 1시간 후 자동 삭제
- **EXPIRE**: **데이터의 유효 기간을 설정** 이미 존재하는 Key에 TTL을 추가  
  예: `EXPIRE session:123 3600` → 해당 Key가 1시간 후 삭제됨
---

#### 2. 언어별 연결 예시

##### FastAPI (aioredis)
```python
import aioredis
redis = await aioredis.from_url("redis://localhost:6379")
await redis.setex("user:1", 60, "cached user data")
```

##### Spring Boot

```java
@Bean
public RedisConnectionFactory redisConnectionFactory() {
    return new LettuceConnectionFactory("localhost", 6379);
}
```

##### Express / NestJS

```javascript
import { createClient } from "redis";
const redis = createClient({ url: "redis://localhost:6379" });
await redis.connect();
```

---

#### 3. TTL & Eviction

| 정책               | 설명                       | 명령어                                        |
| ---------------- | ------------------------ | ------------------------------------------ |
| **volatile-lru** | TTL이 설정된 키 중 LRU 방식으로 삭제 | `CONFIG SET maxmemory-policy volatile-lru` |
| **allkeys-lfu**  | 모든 키 중 사용빈도 기반 제거        | `maxmemory-policy allkeys-lfu`             |
| **volatile-ttl** | TTL이 가장 짧은 키 우선 삭제       |                                            |
| **noeviction**   | 삭제 안 함 (쓰기 실패 발생)        |                                            |

---

#### 4. 헬스체크

```bash
$ redis-cli ping
PONG
```

Spring Boot Actuator 연동:

```yaml
management:
  health:
    redis:
      enabled: true
```

---