---
title: "λ³΄μ• μ •μ±… λ° μ‹¤λ¬΄ μ μ© κ°€μ΄λ“ (Security Practices & Hardening Guide)"
date: 2025-10-25
---

#### μ”μ•½

- μ„λΉ„μ¤ ν™κ²½μ—μ„ κ°€μ¥ μ¤‘μ”ν• λ³΄μ• ν•­λ©μ€ **λΉ„λ°€μ •λ³΄ λ³΄νΈ(Secrets Management)** μ΄λ‹¤.  
- Spring Bootμ—μ„λ” **Jasypt**λ΅ ν™κ²½λ³€μλ‚ μ„¤μ •νμΌμ„ μ•”νΈν™”ν•  μ μλ‹¤.  
- Python, Node.js, NestJS ν™κ²½μ—μ„λ” **dotenv + Vault + KMS** μ΅°ν•©μΌλ΅ λ™μΌν• ν¨κ³Όλ¥Ό μ–»λ”λ‹¤.  
- λ³Έ λ¬Έμ„λ” **Jasypt μ•”νΈν™” μ μ© μμ‹ + Vault μ—°λ™ + μ΄μ ν™κ²½λ³„ κ΄€λ¦¬ μ „λµ**κΉμ§€ ν¬ν•¨ν•λ‹¤.


> Jasyptλ” Spring Boot μƒνƒκ³„μ—μ„ κ°€μ¥ μ™„μ„±λ„ λ†’μ€ μ„¤μ • μ•”νΈν™” λ„κµ¬μ΄λ©°,
> FastAPI/Express/NestJS ν™κ²½μ—μ„λ” λ™μΌ κ°λ…μ„
> **dotenv + crypto + Vault** μ΅°ν•©μΌλ΅ κµ¬ν„ν•λ©΄ λ™μΌν• λ³΄μ• ν¨κ³Όλ¥Ό μ–»μ„ μ μλ‹¤.
>
> μ΄μν™κ²½ λ³΄μ•μ ν•µμ‹¬μ€ **"λΉ„λ°€μ€ μ½”λ“κ°€ μ•„λ‹ μ™Έλ¶€μ—μ„ κ΄€λ¦¬λλ” κ²ƒ"**,
> μ¦‰, **ν™κ²½ λ³€μΒ·VaultΒ·Jasyptκ°€ μ΅°ν™”λ κ΄€λ¦¬ μ²΄κ³„**λ¥Ό κµ¬μ¶•ν•λ” κ²ƒμ΄λ‹¤.
---

###  1. Jasypt κ°μ” (Spring Boot ν™κ²½)

**Jasypt(Java Simplified Encryption)**  
β†’ ν™κ²½ μ„¤μ • νμΌ(`application.yml`/`.properties`)μ λ―Όκ°μ •λ³΄(DB ν¨μ¤μ›λ“, API Key λ“±)μ„ μ•”νΈν™”ν•λ” λΌμ΄λΈλ¬λ¦¬.

| ν•­λ© | μ„¤λ… |
|------|------|
| **μ•”νΈν™” μ•κ³ λ¦¬μ¦** | PBEWithMD5AndDES, PBEWithHMACSHA512AndAES_256 λ“± |
| **μ§€μ› λ²„μ „** | Spring Boot 2.x / 3.x μ΄μƒ |
| **κΈ°λ³Έ ν•νƒ** | `ENC(encrypted_text)` |
| **μ μ© μμ—­** | `application.yml`, ν™κ²½ λ³€μ, Vault μ—°λ™ κ°’ |

---

### 1.1 Maven/Gradle μμ΅΄μ„± μ¶”κ°€

```xml
<dependency>
  <groupId>com.github.ulisesbocchio</groupId>
  <artifactId>jasypt-spring-boot-starter</artifactId>
  <version>3.0.5</version>
</dependency>
```

λλ” Gradle

```groovy
implementation 'com.github.ulisesbocchio:jasypt-spring-boot-starter:3.0.5'
```

---

### 1.2 μ•”νΈν™” ν‚¤ μ„¤μ •

```yaml
jasypt:
  encryptor:
    password: ${JASYPT_ENCRYPTOR_PASSWORD}
    algorithm: PBEWithHMACSHA512AndAES_256
    iv-generator-classname: org.jasypt.iv.RandomIvGenerator
```

ν™κ²½ λ³€μ μμ‹:

```bash
export JASYPT_ENCRYPTOR_PASSWORD="myStrongSecretKey"
```

---

### 1.3 μ•”νΈν™” μ‹¤ν–‰

```bash
# μ•”νΈν™” λ…λ Ή μ‹¤ν–‰ (Linux)
java -cp myapp.jar com.ulisesbocchio.jasyptspringboot.encryptor.SimpleAsymmetricStringEncryptor "plainText"
```

λλ” IDE/CLIμ—μ„:

```bash
$ mvn jasypt:encrypt-value -Djasypt.encryptor.password=myStrongSecretKey -Djasypt.plugin.value="myDbPass"
Encrypted: ENC(2aSDeuR2ezr5O7ZJ0==)
```

---

### 1.4 μ„¤μ • μμ‹ (`application.yml`)

```yaml
spring:
  datasource:
    url: jdbc:postgresql://localhost:5432/appdb
    username: ENC(G2plxZ4u8xTe1m4==)
    password: ENC(4hsk2Llw3ld/9s==)
```

μ• ν”λ¦¬μΌ€μ΄μ… μ‹¤ν–‰ μ‹ `JASYPT_ENCRYPTOR_PASSWORD` ν™κ²½ λ³€μλ¥Ό ν†µν•΄ λ³µνΈν™” μν–‰.

---

### 1.5 Vault + Jasypt μ—°λ™ (ν•μ΄λΈλ¦¬λ“ κµ¬μ„±)

Jasyptλ΅ μ•”νΈν™”λ κΈ°λ³Έκ°’μ„ μ μ§€ν•λ©΄μ„,
Vaultλ¥Ό ν†µν•΄ ν‚¤λ¥Ό μ£Όμ…λ°›μ•„ **μ¤‘μ•™ κ΄€λ¦¬ν• ν‚¤ κµμ²΄(Secret Rotation)** κµ¬ν„ κ°€λ¥.

```yaml
spring:
  cloud:
    vault:
      uri: http://vault.example.com:8200
      authentication: token
      token: ${VAULT_TOKEN}
  jasypt:
    encryptor:
      password: ${VAULT:JASYPT_KEY}
```

> Vault λ‚΄λ¶€ `secret/application` κ²½λ΅μ— `JASYPT_KEY` λ“±λ΅

---

## π 2. FastAPI / Python ν™κ²½ λ€μ‘

> Pythonμ—μ„λ” **python-jasypt** λ€μ•μ΄ μ—†μΌλ―€λ΅,
> `cryptography`, `Fernet`, `python-dotenv`, `Vault`λ¥Ό μ΅°ν•©ν•λ‹¤.

#### μ•”νΈν™”/λ³µνΈν™” μμ‹

```python
from cryptography.fernet import Fernet
key = Fernet.generate_key()
cipher = Fernet(key)
encrypted = cipher.encrypt(b"my_password")
decrypted = cipher.decrypt(encrypted)
```

#### ν™κ²½ λ³€μ κ΄€λ¦¬

```bash
# .env νμΌ
DB_PASSWORD=ENC(gAAAAABn5t...)
SECRET_KEY=my_secret
```

#### FastAPI μ—°λ™

```python
from dotenv import load_dotenv
import os
load_dotenv()
DB_PASS = os.getenv("DB_PASSWORD")
```

Vault λλ” AWS Secrets Managerλ¥Ό ν™μ©ν•μ—¬ `os.environ` κ°’ μ£Όμ… κ°€λ¥.

---

## π© 3. Express / Node.js ν™κ²½ λ€μ‘

> Node.jsμ—μ„λ” Jasypt λ€μ‹  **crypto** λλ” **dotenv + KMS/Vault** μ΅°ν•©μ„ μ‚¬μ©ν•λ‹¤.

#### crypto κΈ°λ° μ•”νΈν™” μμ‹

```javascript
import crypto from "crypto";
const secret = process.env.SECRET_KEY;
const cipher = crypto.createCipher("aes-256-cbc", secret);
let encrypted = cipher.update("myPassword", "utf8", "base64");
encrypted += cipher.final("base64");
```

#### .env νμΌ

```
DB_USER=admin
DB_PASS=ENC(Y2phf2xqaXNzZ...)
```

λ³µνΈν™” μ ν‹Έ:

```javascript
function decrypt(encValue, key) {
  const decipher = crypto.createDecipher("aes-256-cbc", key);
  let decrypted = decipher.update(encValue, "base64", "utf8");
  return decrypted + decipher.final("utf8");
}
```

#### Vault μ—°λ™

```bash
vault kv get secret/app | jq '.data.data'
```

---

## π¦ 4. NestJS ν™κ²½

> NestJSλ” ConfigModule + dotenv + crypto μ΅°ν•©μΌλ΅
> ν™κ²½ λ³€μ μ•”νΈν™”/λ³µνΈν™”λ¥Ό μν–‰ν•λ‹¤.

#### 4.1 ConfigModule μ „μ—­ λ“±λ΅

```typescript
@Module({
  imports: [
    ConfigModule.forRoot({
      isGlobal: true,
      envFilePath: '.env',
    }),
  ],
})
export class AppModule {}
```

#### 4.2 μ•”νΈν™” μ ν‹Έ

```typescript
import * as crypto from 'crypto';

export const decrypt = (data: string, key: string) => {
  const decipher = crypto.createDecipher('aes-256-cbc', key);
  let decrypted = decipher.update(data, 'base64', 'utf8');
  decrypted += decipher.final('utf8');
  return decrypted;
};
```

#### 4.3 Jasypt μ μ‚¬ κµ¬μ΅° ν™μ©

```
DB_USER=ENC(YmFzZTY0RW5jcnlwdGVk)
DB_PASS=ENC(YWJjZGVmZw==)
```

λ³µνΈν™” μ‹ `ConfigService` λ‚΄μ—μ„ μ²λ¦¬:

```typescript
const pass = decrypt(process.env.DB_PASS, process.env.SECRET_KEY);
```

---

## π” 5. μ΄μ λ³΄μ• μ „λµ (κ³µν†µ)

| ν•­λ©                  | μ„¤λ…                        | κ¶μ¥ λ„κµ¬                      |
| ------------------- | ------------------------- | -------------------------- |
| **λΉ„λ°€ κ΄€λ¦¬**           | μ™Έλ¶€ μ €μ¥μ†λ΅ κ΄€λ¦¬                | Vault, AWS Secrets Manager |
| **ν™κ²½ λ³€μ μ•”νΈν™”**       | Jasypt / crypto / Fernet  | μ–Έμ–΄λ³„                        |
| **ν‚¤ νμ „ (Rotation)** | μ£ΌκΈ°μ  ν‚¤ κµμ²΄                  | Vault Lease, Cron          |
| **μ •μ±… μ μ©**           | μµμ† κ¶ν•(Least Privilege) μ›μΉ™ | IAM Policy                 |
| **κ°μ‚¬ λ΅κ·Έ**           | μ ‘κ·Ό μ΄λ²¤νΈ κΈ°λ΅                 | Loki / Sentry              |
| **μλ™ν™” μ κ²€**          | μΆ…μ†μ„± λ³΄μ• μ¤μΊ”                 | Trivy / npm audit / Bandit |

---

##  6. Jasypt vs dotenv vs Vault λΉ„κµ

| ν•­λ©     | Spring Boot (Jasypt) | Python (dotenv + Fernet) | Node/Nest (crypto + dotenv) |
| ------ | -------------------- | ------------------------ | --------------------------- |
| μ•”νΈν™” λ°©μ‹ | λ€μΉ­ν‚¤ κΈ°λ°               | Fernet (AES128 GCM)      | AES-256-CBC                 |
| ν‚¤ κ΄€λ¦¬   | ν™κ²½λ³€μ / Vault         | ν™κ²½λ³€μ                     | dotenv / ConfigModule       |
| ν†µν•©λ„    | Spring Securityμ™€ μ—°λ™  | μλ™ κ΄€λ¦¬                    | ConfigService μλ™ν™”           |
| νμ „ κ΄€λ¦¬  | Vault μ—°κ³„ κ°€λ¥          | Manual                   | Manual / Cron               |
| μ΄μ λ‚μ΄λ„ | λ‚®μ (μλ™λ³µνΈν™” μ§€μ›)        | μ¤‘κ°„                       | μ¤‘κ°„                          |

---

