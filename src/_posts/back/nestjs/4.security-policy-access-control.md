---
title: "RBAC / ABAC / Policy 기반 인가"
date: 2025-10-25
---

**version: NestJS v10.x / Casl v6.x 기준**

---

#### 요약

인가(Authorization)는 사용자가 **무엇을 할 수 있는가**를 제어한다.  
RBAC(Role-Based Access Control)과 ABAC(Attribute-Based Access Control)는  
대규모 시스템의 **정책 기반 접근제어(Policy Enforcement)** 핵심 모델이다.

RBAC은 **역할 중심**, ABAC은 **속성 중심**, Policy는 **행동 규칙 중심** 접근이다.
NestJS에서는 CASL을 통해 **세밀하고 선언적인 인가 구조**를 구성할 수 있다.

> *“권한은 코드가 아니라 정책으로 관리해야 한다.”*

---

##### 참고자료
- [CASL (NestJS Policy Module)](https://casl.js.org/)
- [NIST Access Control Models](https://csrc.nist.gov/projects/access-control)

---

#### 1. RBAC (Role 기반 접근제어)

```ts
if (user.role !== 'admin') throw new ForbiddenException();
```

> 단순 Role 매핑으로 빠르게 접근 제어 가능하나, 세밀한 조건 제어는 어렵다.

---

#### 2. ABAC (속성 기반 접근제어)

```ts
if (user.department === resource.department && user.level > 3) return true;
```

> 사용자 속성과 리소스 속성의 조합으로 접근 권한을 판단한다.

---

#### 3. Policy 기반 인가 (CASL)

```ts
const ability = defineAbility((can, cannot) => {
  can('read', 'Article');
  cannot('delete', 'Article');
});
```

`guard.ts`

```ts
@UseGuards(PoliciesGuard)
@CheckPolicies((ability) => ability.can('read', Article))
```

---

