---
title: "Webpack overview"
date: 2025-10-16
---

# Webpack devserver

ì¢‹ì•„ìš”. **webpack-dev-serverë§Œ ë²„ì „ ëª…ì‹œ**í•´ì„œ ì¶”ê°€ ì •ë¦¬í•´ë“œë¦´ê²Œìš”. (ì´ì „ ë§¥ë½ ìœ ì§€)

## ğŸ“¦ íŒ¨í‚¤ì§€

* **webpack-dev-server**: `^4.15.2`

### ì„¤ì¹˜

```bash
npm i -D webpack-dev-server@^4.15.2
```

### package.json (ë°œì·Œ)

```json
{
  "devDependencies": {
    "webpack-dev-server": "^4.15.2"
  },
  "scripts": {
    "start": "webpack serve --config webpack.dev.js --mode development"
  }
}
```

### webpack.dev.js (devServer ì„¤ì • ì˜ˆì‹œ â€“ ë³€ê²½ ì—†ìŒ)

```js
module.exports = {
  // ...
  devServer: {
    port: 5173,
    host: '0.0.0.0',
    hot: true,
    open: true,
    compress: true,
    historyApiFallback: true,
    static: { directory: path.resolve(__dirname, 'public'), watch: true },
    client: { overlay: true },
  },
};
```

# ì˜µì…˜ A) `ENV_FILE` í™˜ê²½ë³€ìˆ˜ë¡œ ìŠ¤ìœ„ì¹­ (ê°€ì¥ ë‹¨ìˆœ/ëª…í™•)

## 1) íŒ¨í‚¤ì§€ ìŠ¤í¬ë¦½íŠ¸ ì¶”ê°€ (`cross-env` ì‚¬ìš©)

```json
{
  "scripts": {
    "start:local": "cross-env ENV_FILE=./env/env_local webpack serve --config webpack.dev.js --mode development",
    "start:dev":   "cross-env ENV_FILE=./env/env_dev   webpack serve --config webpack.dev.js --mode development",

    "build:dev":  "cross-env ENV_FILE=./env/env_dev  webpack --config webpack.prod.js --mode production",
    "build:prod": "cross-env ENV_FILE=./env/env_prod webpack --config webpack.prod.js --mode production"
  },
  "devDependencies": {
    "cross-env": "^7.0.3"
  }
}
```

> `cross-env`ê°€ OS ìƒê´€ì—†ì´ `ENV_FILE`ì„ ì„¤ì •í•´ì¤˜.

## 2) `webpack.dev.js` / `webpack.prod.js` ìˆ˜ì •

```js
// webpack.dev.js
const path = require('path');
const { merge } = require('webpack-merge');
const Dotenv = require('dotenv-webpack');
const fs = require('fs');
const common = require('./webpack.common');

const envPath = process.env.ENV_FILE || './env/env_dev';
if (!fs.existsSync(path.resolve(__dirname, envPath))) {
  throw new Error(`ENV file not found: ${envPath}`);
}

module.exports = merge(common, {
  mode: 'development',
  devtool: 'eval-cheap-module-source-map',
  output: { filename: 'js/[name].js', chunkFilename: 'js/[name].chunk.js' },
  devServer: {
    port: 5173, open: true, hot: true, historyApiFallback: true,
    static: { directory: path.resolve(__dirname, 'public'), watch: true },
  },
  plugins: [
    new Dotenv({
      path: envPath,          // <-- ì—¬ê¸°ë§Œ ENV_FILEë¡œ ì£¼ì…
      allowEmptyValues: true,
      systemvars: true,
    }),
  ],
});
```

```js
// webpack.prod.js
const path = require('path');
const { merge } = require('webpack-merge');
const Dotenv = require('dotenv-webpack');
const CopyWebpackPlugin = require('copy-webpack-plugin');
const { CleanWebpackPlugin } = require('clean-webpack-plugin');
const fs = require('fs');
const common = require('./webpack.common');

const envPath = process.env.ENV_FILE || './env/env_prod';
if (!fs.existsSync(path.resolve(__dirname, envPath))) {
  throw new Error(`ENV file not found: ${envPath}`);
}

module.exports = merge(common, {
  mode: 'production',
  devtool: 'source-map',
  output: {
    path: path.resolve(__dirname, 'dist'),
    clean: true,
    filename: 'js/[name].[contenthash:8].js',
    chunkFilename: 'js/[name].[contenthash:8].chunk.js',
  },
  plugins: [
    new CleanWebpackPlugin(),
    new Dotenv({
      path: envPath,          // <-- ì—¬ê¸°ë§Œ ENV_FILEë¡œ ì£¼ì…
      allowEmptyValues: true,
      systemvars: true,
    }),
    new CopyWebpackPlugin({
      patterns: [
        { from: path.resolve(__dirname, 'public'),
          to: path.resolve(__dirname, 'dist'),
          globOptions: { ignore: ['**/index.html'] } },
      ],
    }),
  ],
  optimization: {
    splitChunks: {
      chunks: 'all',
      cacheGroups: {
        vendor: { test: /[\\/]node_modules[\\/]/, name: 'vendors', priority: -10, reuseExistingChunk: true }
      },
    },
    runtimeChunk: 'single',
  },
});
```

### ì‚¬ìš©ë²•

```bash
# ë¡œì»¬ ê°œë°œ
npm run start:local   # -> ./env/env_local ì‚¬ìš©
npm run start:dev     # -> ./env/env_dev ì‚¬ìš©

# ë°°í¬ ë²ˆë“¤
npm run build:dev     # -> ./env/env_dev
npm run build:prod    # -> ./env/env_prod
```

---

# ì˜µì…˜ B) `--env target=dev|prod` í”Œë˜ê·¸ë¡œ ìŠ¤ìœ„ì¹­ (Webpack í‘œì¤€ ìŠ¤íƒ€ì¼)

> ì¥ì : Webpackì˜ `env` ë©”ì»¤ë‹ˆì¦˜ ì‚¬ìš©. CIì—ì„œ ê°€ë…ì„± ì¢‹ìŒ.

## 1) ìŠ¤í¬ë¦½íŠ¸

```json
{
  "scripts": {
    "start": "webpack serve --config webpack.dev.js --env target=dev --mode development",
    "start:local": "webpack serve --config webpack.dev.js --env target=local --mode development",
    "build:dev": "webpack --config webpack.prod.js --env target=dev --mode production",
    "build:prod": "webpack --config webpack.prod.js --env target=prod --mode production"
  }
}
```

## 2) `webpack.dev.js` / `webpack.prod.js`ë¥¼ í•¨ìˆ˜í˜•ìœ¼ë¡œ ë³€ê²½

```js
// webpack.dev.js
const path = require('path');
const { merge } = require('webpack-merge');
const Dotenv = require('dotenv-webpack');
const fs = require('fs');
const common = require('./webpack.common');

const FILE_MAP = {
  local: './env/env_local',
  dev:   './env/env_dev',
  prod:  './env/env_prod',
};

module.exports = (env = {}) => {
  const target = env.target || 'dev';
  const envPath = FILE_MAP[target] || FILE_MAP.dev;
  if (!fs.existsSync(path.resolve(__dirname, envPath))) {
    throw new Error(`ENV file not found: ${envPath}`);
  }

  return merge(common, {
    mode: 'development',
    devtool: 'eval-cheap-module-source-map',
    output: { filename: 'js/[name].js', chunkFilename: 'js/[name].chunk.js' },
    devServer: {
      port: 5173, open: true, hot: true, historyApiFallback: true,
      static: { directory: path.resolve(__dirname, 'public'), watch: true },
    },
    plugins: [
      new Dotenv({ path: envPath, allowEmptyValues: true, systemvars: true }),
    ],
  });
};
```

```js
// webpack.prod.js
const path = require('path');
const { merge } = require('webpack-merge');
const Dotenv = require('dotenv-webpack');
const CopyWebpackPlugin = require('copy-webpack-plugin');
const { CleanWebpackPlugin } = require('clean-webpack-plugin');
const fs = require('fs');
const common = require('./webpack.common');

const FILE_MAP = {
  local: './env/env_local',
  dev:   './env/env_dev',
  prod:  './env/env_prod',
};

module.exports = (env = {}) => {
  const target = env.target || 'prod';
  const envPath = FILE_MAP[target] || FILE_MAP.prod;
  if (!fs.existsSync(path.resolve(__dirname, envPath))) {
    throw new Error(`ENV file not found: ${envPath}`);
  }

  return merge(common, {
    mode: 'production',
    devtool: 'source-map',
    output: {
      path: path.resolve(__dirname, 'dist'),
      clean: true,
      filename: 'js/[name].[contenthash:8].js',
      chunkFilename: 'js/[name].[contenthash:8].chunk.js',
    },
    plugins: [
      new CleanWebpackPlugin(),
      new Dotenv({ path: envPath, allowEmptyValues: true, systemvars: true }),
      new CopyWebpackPlugin({
        patterns: [
          { from: path.resolve(__dirname, 'public'),
            to: path.resolve(__dirname, 'dist'),
            globOptions: { ignore: ['**/index.html'] } },
        ],
      }),
    ],
    optimization: {
      splitChunks: { chunks: 'all',
        cacheGroups: { vendor: { test: /[\\/]node_modules[\\/]/, name: 'vendors', priority: -10, reuseExistingChunk: true } },
      },
      runtimeChunk: 'single',
    },
  });
};
```

### ì‚¬ìš©ë²•

```bash
# dev í™˜ê²½
npm run start                 # --env target=dev
npm run build:dev            # --env target=dev

# prod í™˜ê²½
npm run build:prod           # --env target=prod
```

---

## ë³´ë„ˆìŠ¤: ëŸ°íƒ€ì„ ì£¼ì˜ì‚¬í•­ & íŒ

* **ë¹Œë“œíƒ€ì„ ì£¼ì…**: `dotenv-webpack`ëŠ” **í´ë¼ì´ì–¸íŠ¸ ë²ˆë“¤ì— ê°’ì´ í¬í•¨**ë˜ë¯€ë¡œ,
  **ì ˆëŒ€ ë¹„ë°€í‚¤/ìê²©ì¦ëª…**ì„ ë„£ì§€ ë§ˆì„¸ìš”. (ë°±ì—”ë“œ/í”„ë¡ì‹œì—ì„œ ë³´í˜¸)
* **ìš°ì„ ìˆœìœ„ ê¶Œì¥**: `ENV_FILE`(ì˜µì…˜ A)ë‚˜ `--env target`(ì˜µì…˜ B)ë¡œ **ëª…ì‹œì  ì§€ì • > ê¸°ë³¸ê°’** ìˆœì„œ ê¶Œì¥.
* **íƒ€ì… ì§€ì›**: í•„ìš”í•œ ê²½ìš° `src/env.d.ts` ë§Œë“¤ì–´ `process.env.API_URL` ë“± íƒ€ì… ì„ ì–¸í•´ë‘ë©´ ì¢‹ìŒ.
* **í™˜ê²½ë³„ í¼ë¸”ë¦­ ê²½ë¡œ**: S3/CloudFront ë“± ì‚¬ìš© ì‹œ `output.publicPath`ë¥¼ `.env`ì˜ `PUBLIC_PATH`ë¡œ ì „í™˜ ê°€ëŠ¥.

---
