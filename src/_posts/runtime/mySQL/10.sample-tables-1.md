---
title: "MySQL SQL 작성 및 운영 모범 사례 (Best Practices)"
date: 2025-10-26
---

**version: 8.0.x**

---

#### 요약

- MySQL 환경에서 **안전하고 효율적인 SQL 작성 및 운영을 위한 실무 가이드**이다.  
- SQL 구문 작성, 쿼리 최적화, 백업/복원, 보안 설정, 버전 관리까지 포함한다.  
- 본 문서는 **개발자·운영자(DBA)** 모두가 공통적으로 참고할 수 있는 표준 가이드라인이다.

> MySQL 운영의 핵심은 **일관성과 복구 가능성**이다.
> SQL은 단순한 코드가 아니라, 데이터 안정성을 책임지는 명세이므로
> "읽기 쉬운 쿼리 = 유지보수 가능한 서비스"라는 원칙으로 작성해야 한다.
> 성능·보안·가독성을 동시에 만족시키는 것이 진정한 **Best Practice**다.


**핵심 포인트**
1. SQL 문법 및 스타일 규칙  
2. DDL/DML 실행 시 주의점  
3. 쿼리 성능 개선 전략  
4. 백업/복원 관리  
5. 보안 및 사용자 권한 운영 원칙  

---

##### 참고자료  
- [공식 문서: MySQL Optimization Reference](https://dev.mysql.com/doc/refman/8.0/en/optimization.html)  
- 내부 문서:  
  - `01-installation.md` — 환경 구성 및 버전 관리  
  - `01-core-languages/04-tcl.md` — 트랜잭션 제어 및 복구  
  - `03-tools-and-management/02-backup-restore.md` — 백업·복원 절차  

---

#### 1. SQL 작성 규칙

| 규칙 | 설명 |
|------|------|
| **대문자 규칙** | SQL 키워드(SELECT, FROM, WHERE)는 대문자, 식별자는 소문자 |
| **세미콜론(;) 필수** | 모든 문장 끝에 `;` 필수 |
| **들여쓰기 정렬** | 각 절은 한 줄씩 구분하여 가독성 확보 |
| **주석 사용** | `--` 또는 `/* */` 형태로 작성 의도 명시 |
| **컬럼 지정 원칙** | `SELECT *` 금지 — 필요한 컬럼만 선택 |

예시:
```sql
select
    number,
    name,
    age
from tb1k
where age >= 30
order by age desc;
```

---

#### 2. DDL / DML 실행 시 주의사항

* **DDL (CREATE / ALTER / DROP)**

  * 자동 커밋이므로 트랜잭션 복구 불가
  * 구조 변경 전 `show create table` 백업 필수

* **DML (INSERT / UPDATE / DELETE)**

  * 항상 `WHERE` 절 포함
  * `autocommit=0` 설정 후 `commit` / `rollback` 명시

* **ALTER TABLE**

  * 데이터가 많은 테이블은 Online DDL 옵션 고려 (`ALGORITHM=INPLACE`)

---

#### 3. 트랜잭션 기반 실행 전략

```sql
set autocommit = 0;
start transaction;
update tb set sales = sales + 10 where number = 'A101';
commit;
```

> 💡 DML 실행 시 반드시 “트랜잭션 단위로 묶어서” 수행해야 함.
> 단일 명령으로도 트랜잭션 원자성을 유지할 수 있음.

---

#### 4. 쿼리 성능 최적화

| 전략             | 설명                               |
| -------------- | -------------------------------- |
| **인덱스(Index)** | WHERE, JOIN, ORDER BY 컬럼에 인덱스 생성 |
| **LIMIT 사용**   | 불필요한 전체 조회 방지                    |
| **JOIN 최적화**   | INNER JOIN 시 작은 테이블 기준으로 조인      |
| **EXPLAIN 활용** | 실행 계획 확인으로 풀스캔 여부 확인             |
| **서브쿼리 최소화**   | JOIN으로 대체 시 성능 향상                |

예시:

```sql
explain select * from tb where sales > 200;
```

결과 해석:

* `type='ALL'` → 풀스캔 (비효율적)
* `key` 컬럼 값 존재 → 인덱스 사용 중

---

#### 5. 백업 및 복원

```bash
# 전체 DB 백업
mysqldump -u root -p addrdb > addrdb_backup.sql

# 특정 테이블만 백업
mysqldump -u root -p addrdb tb1k > tb1k_backup.sql

# 복원
mysql -u root -p addrdb < addrdb_backup.sql
```

> ⚙️ 정기 백업은 운영 환경의 생명선이다.
> 자동화 스크립트를 만들어 하루 1회 백업을 권장한다.

---

#### 6. 보안 및 권한 운영 원칙

| 원칙             | 내용                                   |
| -------------- | ------------------------------------ |
| 최소 권한 원칙       | 필요한 DB/테이블만 접근 허용                    |
| root 직접 로그인 제한 | `sudo mysql` 또는 관리자 계정 분리            |
| 비밀번호 복잡도 강화    | `validate_password_policy=STRONG` 설정 |
| SSL/TLS 연결 사용  | `require ssl` 옵션 권장                  |
| 주기적 권한 검토      | `show grants for 'user'@'host';`     |

예시:

```sql
grant select, insert on addrdb.* to 'readonly'@'%';
flush privileges;
```

---

#### 7. 로그 관리 및 모니터링

| 로그 종류                   | 경로                         | 목적        |
| ----------------------- | -------------------------- | --------- |
| 일반 로그 (general_log)     | `/var/lib/mysql/mysql.log` | 전체 쿼리 기록  |
| 슬로우 로그 (slow_query_log) | `/var/lib/mysql/slow.log`  | 느린 쿼리 분석  |
| 에러 로그                   | `/var/log/mysql/error.log` | 시스템 오류 추적 |

```sql
set global slow_query_log = 1;
set global long_query_time = 1;
```

---

#### 8. 버전 및 호환성 관리

| 항목            | 설명                                             |
| ------------- | ---------------------------------------------- |
| SQL_MODE      | `STRICT_TRANS_TABLES`, `ONLY_FULL_GROUP_BY` 권장 |
| CHARACTER SET | `utf8mb4`로 통일                                  |
| TIMEZONE      | 운영 환경 표준 시간대(`Asia/Seoul`) 고정                  |

예시:

```sql
set global time_zone = 'Asia/Seoul';
```

---

#### 9. SQL 품질 점검 흐름 (Mermaid)

```mermaid
flowchart LR
    A[SQL 작성] --> B[구문 점검 (DESC, SHOW)]
    B --> C[EXPLAIN으로 실행 계획 확인]
    C --> D{성능 기준 통과?}
    D -- No --> E[인덱스/쿼리 수정]
    D -- Yes --> F[Commit 및 로그 기록]
```

---

#### 10. 운영 수칙

1. 실시간 서비스 테이블 변경 전 Always Backup
2. 외부 접근 시 IP 화이트리스트 등록
3. DB 접속 로그를 보관 주기별로 회전(logrotate)
4. 신규 SQL 배포 시 `staging` 환경에서 사전 검증

---

