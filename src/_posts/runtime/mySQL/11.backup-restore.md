---
title: "MySQL 백업 및 복원 관리 (Backup & Restore Management)"
date: 2025-10-26
---

**version: 8.0.x**

#### 요약

- MySQL 운영의 핵심은 **데이터 무결성과 복원력(Recoverability)** 이다.  
- 본 문서는 MySQL의 기본 백업(`mysqldump`), 고속 복원(`mysqlimport`),  
  그리고 실무에서 사용하는 **자동화·증분 백업 전략**을 다룬다.  
- CLI와 GUI(DBeaver, Workbench) 환경 모두에서 동일한 백업 정책을 적용할 수 있다.

> MySQL 백업은 단순한 복제가 아닌 **시점 복원(Point-in-Time Recovery)** 을 가능하게 하는 핵심 절차이다.
> 정기 백업 + 증분 로그 관리 + 외부 저장소 이중화의 3단계 전략을 병행하면
> 장애 시에도 데이터 손실을 최소화할 수 있다.
> 모든 운영 환경에서 “백업은 선택이 아닌 **생존 조건(Survival Requirement)**” 이다.


**핵심 포인트**
1. 백업 유형: 전체 / 테이블별 / 증분  
2. `mysqldump` 명령 및 옵션  
3. 복원(`mysql < file.sql`) 절차  
4. 스케줄링 및 자동화(cron)  
5. 운영 환경 복원 전략  

---

##### 참고자료  
- [공식 문서: MySQL Backup and Recovery](https://dev.mysql.com/doc/refman/8.0/en/backup-and-recovery.html)  
- 내부 문서:
  - `02-practice-and-debug/05-performance-tips.md` — 성능 영향 최소화 백업 전략  
  - `03-tools-and-management/04-logging-monitoring.md` — 로그 기반 복원 시 참고  

---

#### 1. 백업 유형

| 유형 | 설명 | 예시 |
|------|------|------|
| 전체 백업 (Full Backup) | DB 전체를 덤프 파일로 저장 | `mysqldump -u root -p addrdb > addrdb.sql` |
| 테이블 백업 (Partial) | 특정 테이블만 백업 | `mysqldump -u root -p addrdb tb1k > tb1k.sql` |
| 증분 백업 (Incremental) | 변경분만 백업 (Binary Log 기반) | `mysqlbinlog` 사용 |
| 논리 백업 | SQL 스크립트 형태 | `mysqldump` |
| 물리 백업 | 파일 복사 기반 | `cp /var/lib/mysql` |

> 💡 백업 전략은 운영 환경에서는 **Full + Incremental 병행**이 일반적이다.

---

#### 2. 기본 백업 명령 (mysqldump)

```bash
mysqldump -u root -p addrdb > addrdb_backup.sql
```

옵션 설명:

| 옵션                      | 의미                 |
| ----------------------- | ------------------ |
| `--single-transaction`  | InnoDB 트랜잭션 일관성 유지 |
| `--routines`            | 저장 프로시저 포함         |
| `--triggers`            | 트리거 포함             |
| `--add-drop-table`      | 기존 테이블 자동 삭제 후 생성  |
| `--flush-logs`          | 로그 플러시             |
| `--set-gtid-purged=OFF` | GTID 복제 환경 제외      |

예시:

```bash
mysqldump -u root -p --single-transaction --routines --triggers addrdb > addrdb_full.sql
```

---

#### 3. 특정 테이블만 백업

```bash
mysqldump -u root -p addrdb tb1k tb > partial_backup.sql
```

> ⚙️ 여러 테이블을 공백으로 구분해 동시에 백업 가능하다.

---

#### 4. 복원 (Restore)

```bash
mysql -u root -p addrdb < addrdb_backup.sql
```

| 복원 단계     | 명령                          |
| --------- | --------------------------- |
| 데이터베이스 생성 | `create database addrdb;`   |
| DB 선택     | `use addrdb;`               |
| SQL 파일 복원 | `source addrdb_backup.sql;` |

> 💡 복원 시 기존 테이블과 중복되면 “Table already exists” 오류가 발생할 수 있으므로
> 백업 시 `--add-drop-table` 옵션 사용을 권장한다.

---

#### 5. 자동 백업 스케줄링 (cron)

```bash
crontab -e
```

예시 (매일 새벽 2시 백업):

```
0 2 * * * mysqldump -u root -p비밀번호 addrdb > /backup/addrdb_$(date +\%F).sql
```

> ✅ 백업 파일명에 날짜를 포함하면 버전 관리가 용이하다.
> (예: `/backup/addrdb_2025-10-26.sql`)

---

#### 6. 증분 백업 (Binary Log 기반)

Binary Log 활성화:

```ini
# /etc/mysql/mysql.conf.d/mysqld.cnf
[mysqld]
log_bin = /var/log/mysql/mysql-bin.log
server_id = 1
```

백업 수행:

```bash
mysqlbinlog /var/log/mysql/mysql-bin.000001 > incremental.sql
```

복원 시:

```bash
mysql -u root -p < incremental.sql
```

> 💡 증분 백업은 대용량 트랜잭션 환경에서 효율적이며,
> 주로 “매일 Full + 매시간 Incremental” 구조로 구성한다.

---

#### 7. GUI 백업 (Workbench / DBeaver)

| 도구                  | 기능                     | 경로                   |
| ------------------- | ---------------------- | -------------------- |
| **MySQL Workbench** | Data Export / Import   | Server → Data Export |
| **DBeaver**         | CSV, SQL, Excel Export | Table → Export Data  |

> Workbench는 `mysqldump` 기반으로 동작하므로,
> CLI와 동일한 결과를 생성한다.

---

#### 8. 백업 파일 검증

```bash
grep -E "CREATE|INSERT" addrdb_backup.sql | head
```

> ⚙️ SQL 구문(`CREATE TABLE`, `INSERT INTO`)이 존재하면 정상 백업임을 의미한다.
> 추가적으로 파일 크기(`ls -lh`)로 데이터 유실 여부를 점검할 수 있다.

---

#### 9. 백업/복원 자동화 흐름도 (Mermaid)

```mermaid
flowchart TD
    A[DB 운영 중] --> B[정기 백업 (mysqldump)]
    B --> C{증분 백업 필요?}
    C -- Yes --> D[Binary Log 추출]
    C -- No --> E[백업 완료]
    D --> F[Backup Storage 저장]
    E --> F
    F --> G[복원 테스트 (mysql < file.sql)]
```

---

#### 10. 운영 환경 복원 전략

| 상황       | 대응 방법                                  |
| -------- | -------------------------------------- |
| 데이터 손상   | 가장 최근 Full + Incremental 조합 복원         |
| 특정 시점 복원 | `mysqlbinlog --stop-datetime="..."` 사용 |
| 서버 장애    | 다른 노드에서 백업 파일 복원                       |
| RDS 환경   | 콘솔에서 Snapshot 복원                       |

> ⚙️ 복원 절차는 “테이블 삭제 → 백업 로드 → 무결성 검증 → 로그 클리어” 순서로 수행한다.

---

#### 11. 실무 팁

1. 백업 파일은 `/backup/mysql/YYYY-MM-DD/` 구조로 정리
2. `gzip` 으로 압축 시 저장 공간 절약 (최대 80%)
3. 백업 파일 무결성 검사는 `md5sum` 으로 수행
4. 운영 환경에서는 반드시 외부 스토리지(NAS, S3)에 이중 저장

```bash
mysqldump addrdb | gzip > addrdb_$(date +%F).sql.gz
md5sum addrdb_$(date +%F).sql.gz > checksum.txt
```

---

