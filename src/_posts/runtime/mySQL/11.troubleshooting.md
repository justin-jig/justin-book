---
title: "MySQL 문제 해결 및 점검 가이드 (Troubleshooting & Diagnostics)"
date: 2025-10-26
---

**version: 8.0.x**

---

#### 요약

- 본 문서는 MySQL 운영 중 발생할 수 있는 대표적인 문제 상황(접속 오류, 트랜잭션 충돌, 서비스 비정상 종료 등)에 대한 **점검 절차와 복구 방법**을 정리한다.  
- CLI 기반 수동 점검부터 로그 분석, 설정 복구, 데이터 무결성 검증까지 포함한다.  


> MySQL 트러블슈팅은 단순한 에러 해결이 아니라
> **“원인 → 로그 → 복구 → 재발 방지”**의 순환 과정이다.
> 주기적 점검(health check)과 백업 자동화를 병행하면,
> 장애 발생 시에도 데이터를 **무손실 복원(Zero Data Loss)** 할 수 있다.

**핵심 포인트**
1. 접속 불가 오류 (`ERROR 1045`, `2002`)  
2. 서비스 비정상 종료 및 재시작 점검  
3. 트랜잭션 교착(Deadlock) 해결 절차  
4. 데이터 손상(Repair Table) 복구  
5. 로그 분석 및 경고 확인  

---

##### 참고자료  
- [공식 문서: MySQL Troubleshooting Reference](https://dev.mysql.com/doc/refman/8.0/en/problems.html)  
- 내부 문서:  
  - `02-practice-and-debug/01-errors-debugging.md` — 오류 코드 상세  
  - `03-tools-and-management/04-logging-monitoring.md` — 로그 설정  

---

#### 1. 접속 불가 (Access Denied / Socket Error)

| 오류 코드 | 메시지 | 원인 | 해결 방법 |
|------------|---------|------|------------|
| `ERROR 1045` | Access denied for user | 비밀번호 불일치 | root 비밀번호 재설정 |
| `ERROR 2002` | Can't connect to local MySQL server | MySQL 데몬 비활성 | 서비스 재시작 |
| `ERROR 1130` | Host is not allowed to connect | 원격 접속 차단 | bind-address 및 grant 수정 |

**해결 명령 예시**
```bash
sudo systemctl restart mysql
sudo mysql -u root
alter user 'root'@'localhost' identified by 'newpass';
flush privileges;
```

---

#### 2. 서비스 상태 점검

```bash
sudo systemctl status mysql
```

출력 예시:

```
● mysql.service - MySQL Community Server
     Loaded: loaded (/lib/systemd/system/mysql.service; enabled)
     Active: active (running) since Sun 2025-10-26 04:00:33 KST
```

> 💡 “inactive(dead)” 상태라면, 로그(`error.log`)에서 포트 충돌 또는 권한 오류 여부를 확인해야 한다.

---

#### 3. 포트 충돌 / 바인딩 문제

```bash
sudo netstat -tulnp | grep 3306
```

| 문제    | 원인                                                       | 해결                       |
| ----- | -------------------------------------------------------- | ------------------------ |
| 포트 점유 | 다른 MySQL 프로세스 실행 중                                       | `sudo kill -9 <PID>`     |
| 설정 충돌 | `/etc/mysql/mysql.conf.d/mysqld.cnf` 의 `bind-address` 확인 | `bind-address = 0.0.0.0` |

---

#### 4. 트랜잭션 교착 (Deadlock) 처리

```sql
show engine innodb status\G
```

결과 예시:

```
LATEST DETECTED DEADLOCK
------------------------
TRANSACTION 1: waiting for lock ...
TRANSACTION 2: holding lock ...
```

**해결 절차**

1. 교착 트랜잭션 쿼리 확인
2. 인덱스 정렬 조건 확인 (`where`, `join` 순서 일치 여부)
3. 필요 시 `rollback` 후 재시도
4. `innodb_lock_wait_timeout` 조정

```sql
set global innodb_lock_wait_timeout = 30;
```

---

#### 5. 테이블 손상 / 데이터 복구

MyISAM 테이블은 손상 시 `REPAIR TABLE` 명령을 통해 복원 가능하다.

```sql
repair table tb1k;
```

> ⚙️ InnoDB 엔진은 자동 복구 기능이 있으며,
> 손상 시 MySQL이 자동으로 `crash recovery` 수행 후 재시작된다.

---

#### 6. 설정 파일 복구 (/etc/mysql/mysql.conf.d/mysqld.cnf)

```bash
sudo vi /etc/mysql/mysql.conf.d/mysqld.cnf
```

| 설정 항목                     | 설명          | 권장값             |
| ------------------------- | ----------- | --------------- |
| `port`                    | MySQL 기본 포트 | 3306            |
| `bind-address`            | 수신 IP       | 0.0.0.0         |
| `max_connections`         | 동시 접속 수     | 200~500         |
| `innodb_buffer_pool_size` | 캐시 메모리 크기   | 시스템 RAM의 50~70% |

변경 후 적용:

```bash
sudo systemctl restart mysql
```

---

#### 7. 로그 분석

| 로그 종류  | 경로                         | 용도        |
| ------ | -------------------------- | --------- |
| 에러 로그  | `/var/log/mysql/error.log` | 서비스 오류 추적 |
| 일반 로그  | `/var/lib/mysql/mysql.log` | 쿼리 실행 내역  |
| 슬로우 로그 | `/var/lib/mysql/slow.log`  | 성능 분석     |

```bash
sudo tail -f /var/log/mysql/error.log
```

> 💡 `InnoDB: Error: Table is marked as crashed` 와 같은 로그가 나오면
> 해당 테이블을 `repair table` 명령으로 복구해야 한다.

---

#### 8. 비정상 종료 후 복구 절차 (Mermaid)

```mermaid
flowchart TD
    A[MySQL 서비스 중단 감지] --> B[로그 분석 (error.log)]
    B --> C{손상된 테이블 존재?}
    C -- Yes --> D[repair table or dump 복원]
    C -- No --> E[conf 설정 확인]
    D --> F[MySQL 재시작]
    E --> F
    F --> G[상태 점검 및 연결 테스트]
```

---

#### 9. 데이터 백업 복구 테스트

```bash
mysql -u root -p addrdb < addrdb_backup.sql
```

* 백업 파일(`mysqldump`)은 주기적으로 최신 버전 유지
* 복원 시 테이블 이름 중복 주의 (`drop table if exists` 옵션 활용)

---

#### 10. 실무 점검 루틴

1. `systemctl status mysql` — 서비스 상태
2. `mysql -u root -p` — CLI 접속 확인
3. `show processlist;` — 세션 확인
4. `show engine innodb status\G` — Deadlock 추적
5. `tail -f error.log` — 로그 모니터링

> ✅ 이 5가지 명령은 모든 MySQL 문제의 출발점이 된다.

---



