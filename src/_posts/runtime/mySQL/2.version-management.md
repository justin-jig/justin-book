---
title: "MySQL 버전 관리 및 업그레이드 가이드 (Version Management & Upgrade)"
date: 2025-10-26
---

**version: 8.0.x**

#### 요약

- MySQL의 버전 업그레이드(5.x → 8.x)는 **SQL Mode, Character Set, Authentication Plugin** 변경을 반드시 고려해야 한다.  
- 본 문서는 CLI 및 Docker 환경에서 **버전 확인, 병행 실행, 업그레이드 전략**을 설명한다.  
- 핵심 포인트  
  1. 버전 확인 명령  
  2. SQL Mode / Character Set 점검  
  3. mysqldump 기반 백업 및 복원  
  4. Docker 다중 버전 실행 비교  
  5. 업그레이드 전후 검증 절차

> MySQL 버전 업그레이드는 단순 패키지 교체가 아니라,
> **데이터 형식, 문자셋, 인증 정책, SQL 모드** 전반의 변화다.
> 따라서 업그레이드 전후에는 **mysqldump 백업, SQL Mode 점검, 실제 쿼리 테스트** 과정을 반드시 수행해야 한다.


---

##### 참고자료  
- [공식 문서: MySQL Upgrade Guide](https://dev.mysql.com/doc/refman/8.0/en/upgrading.html)  

---

#### 1. 버전 확인

```bash
mysql --version
# mysql  Ver 8.0.37 for Linux on x86_64 (MySQL Community Server - GPL)

mysql -u root -p -e "select @@version, @@hostname, @@port;"
```

| 항목       | 예시 결과     |
| -------- | --------- |
| MySQL 버전 | 8.0.37    |
| 호스트      | localhost |
| 포트       | 3306      |

---

#### 2. SQL Mode 점검

MySQL 8.0부터 **`ONLY_FULL_GROUP_BY`** 모드가 기본 활성화되어
`group by` 절에 포함되지 않은 비집계 컬럼은 select할 수 없습니다.

```sql
select @@sql_mode;
```

| 주요 SQL Mode         | 설명                   |
| ------------------- | -------------------- |
| ONLY_FULL_GROUP_BY  | 엄격한 그룹 기준 적용         |
| STRICT_TRANS_TABLES | 잘못된 값 입력 차단          |
| NO_ZERO_DATE        | 잘못된 날짜값 거부           |
| ANSI_QUOTES         | 쌍따옴표를 문자열이 아닌 식별자 처리 |

> ⚙️ 실무 팁: 호환성 테스트를 위해 임시로 모드를 해제할 수 있음
>
> ```sql
> set sql_mode = '';
> ```

---

#### 3. 문자셋(Character Set) 확인 및 설정

MySQL 8.0의 기본 문자셋은 `utf8mb4_0900_ai_ci` 입니다.

```sql
show variables like 'character_set_%';
```

| 항목                       | 값       |
| ------------------------ | ------- |
| character_set_client     | utf8mb4 |
| character_set_connection | utf8mb4 |
| character_set_database   | utf8mb4 |
| character_set_server     | utf8mb4 |

**변경 방법:**

```sql
alter database addrdb character set utf8mb4 collate utf8mb4_general_ci;
```

---

#### 4. 업그레이드 전 백업

```bash
mysqldump -u root -p addrdb > addrdb_backup.sql
```

백업 시 옵션:

| 옵션                      | 설명                |
| ----------------------- | ----------------- |
| `--single-transaction`  | 트랜잭션 일관성 유지       |
| `--routines --triggers` | 함수·트리거 포함         |
| `--add-drop-table`      | 기존 테이블 자동 삭제 후 복원 |

복원:

```bash
mysql -u root -p addrdb < addrdb_backup.sql
```

---

#### 5. Docker 다중 버전 실행 (병행 비교 테스트)

```bash
# MySQL 5.7
docker run -d --name mysql57 -e MYSQL_ROOT_PASSWORD=root -p 3307:3306 mysql:5.7

# MySQL 8.0
docker run -d --name mysql80 -e MYSQL_ROOT_PASSWORD=root -p 3308:3306 mysql:8.0
```

확인:

```bash
docker exec -it mysql57 mysql -u root -p -e "select @@version;"
docker exec -it mysql80 mysql -u root -p -e "select @@version;"
```

| 컨테이너    | 포트   | 버전    |
| ------- | ---- | ----- |
| mysql57 | 3307 | 5.7.x |
| mysql80 | 3308 | 8.0.x |

---

#### 6. 버전별 주요 차이 요약

| 항목              | MySQL 5.x             | MySQL 8.x             |
| --------------- | --------------------- | --------------------- |
| 기본 문자셋          | latin1                | utf8mb4               |
| 인증 플러그인         | mysql_native_password | caching_sha2_password |
| Window Function | ❌ 지원 안 함              | ✅ 지원                  |
| CTE (WITH 구문)   | ❌ 지원 안 함              | ✅ 지원                  |
| JSON 타입         | 제한적                   | 완전 지원                 |
| InnoDB DDL      | 차단형                   | Online DDL 지원         |

---

#### 7. 업그레이드 절차 (Mermaid Flow)

```mermaid
flowchart TD
    A[현재 버전 확인] --> B[데이터 백업 (mysqldump)]
    B --> C[MySQL 서비스 중지]
    C --> D[패키지 업데이트 또는 Docker Pull]
    D --> E[새 버전 설치]
    E --> F[데이터 복원 및 검증]
    F --> G[SQL Mode / Charset 확인]
    G --> H[정상 동작 테스트]
    H --> I{Migration Complete?}
    I -- Yes --> J[서비스 운영 재개]
    I -- No --> K[백업 복원 및 로그 분석]
```

---

#### 8. 검증 및 점검 항목

| 항목        | 점검 방법                                 |
| --------- | ------------------------------------- |
| SQL Mode  | select @@sql_mode;                    |
| 문자셋       | show variables like 'character_set%'; |
| Time Zone | select @@global.time_zone;            |
| 인증 플러그인   | select user, plugin from mysql.user;  |
| 오류 로그     | /var/log/mysql/error.log              |

---

#### 9. 마이그레이션 주의사항

1. 5.7 → 8.0 업그레이드 시 JSON 컬럼 인덱스 확인 필요
2. Foreign Key 제약조건 재검증 필수
3. 암호화 함수(`password()`)는 더 이상 권장되지 않음
4. `mysql_upgrade` 명령은 8.0 이상에서는 자동 수행됨

---
