---
title: "Node.js 보안 전략 — 암호화, HTTPS, 환경 변수, 취약점 대응"
date: 2025-10-24
---

#### 요약
> Node.js는 경량 런타임 특성상 보안 설정이 필수적이다.  
> 애플리케이션 수준에서는 `crypto`, `bcrypt`, `helmet` 등을 활용하여 데이터·통신·구성 정보를 보호해야 하며,  
> 운영 수준에서는 HTTPS, 환경 변수 관리, 의존성 취약점 점검을 함께 수행해야 한다.

- 데이터 보안: **암호화(Hash, Salt, bcrypt)**
- 통신 보안: **HTTPS, TLS 인증서**
- 애플리케이션 보안: **Helmet, Rate Limiter, CORS**
- 환경 보안: **dotenv, npm audit, Dependency 관리**
- 
> **요약:**
>
> * “암호화(데이터 보호)” + “네트워크 보안(HTTPS)” + “구성 보안(.env)”
> * 보안은 기능이 아니라 **운영 원칙(Security as a Practice)** 이다.


##### 참고자료
- [Node.js Security Guide](https://nodejs.org/en/docs/guides/security/)
- [OWASP NodeGoat Project](https://owasp.org/www-project-nodegoat/)
- [Helmet 공식 문서](https://helmetjs.github.io/)
---

#### 1. 데이터 암호화 기본 개념

암호화(Encryption)는 데이터를 안전하게 보호하기 위해 **평문을 암호문으로 변환**하는 과정이다.  
Node.js에서는 `crypto` 모듈과 `bcrypt` 라이브러리가 대표적으로 사용된다.

| 구분 | 단방향 암호화 | 양방향 암호화 |
|------|---------------|---------------|
| 설명 | 원본 복호화 불가 (Hash) | 암호문 → 평문 복호화 가능 |
| 예시 | 비밀번호 저장 | HTTPS 통신, 파일 암호화 |
| 알고리즘 | SHA-256, bcrypt | AES, RSA |

---

#### 2. 단방향 암호화 — 해시(Hash)

##### SHA-256 예시
```js
import crypto from 'crypto';
const hash = crypto.createHash('sha256').update('password123').digest('hex');
console.log(hash); // 해시 결과 (64자리)
```

##### 해시 + Salt (레인보우 공격 방어)

```js
const salt = crypto.randomBytes(16).toString('hex');
const hash = crypto.pbkdf2Sync('password123', salt, 10000, 64, 'sha512').toString('hex');
console.log({ salt, hash });
```

> 💡 **Tip:**
> `pbkdf2Sync`는 반복 해시(Iteration)와 Salt를 적용해 무차별 대입 공격을 방어한다.

---

#### 3. bcrypt를 이용한 비밀번호 암호화

`bcrypt`는 비밀번호 보관을 위한 업계 표준 알고리즘이다.

##### 설치

```bash
$ npm install bcrypt
```

##### 예시

```js
import bcrypt from 'bcrypt';

const password = 'mySecret';
const saltRounds = 10;

// 해싱
const hash = await bcrypt.hash(password, saltRounds);
console.log('Hash:', hash);

// 검증
const isMatch = await bcrypt.compare(password, hash);
console.log('Password Match:', isMatch);
```

> bcrypt는 내부적으로 Blowfish 기반 해시를 수행하며,
> CPU 계산량이 많아 무차별 대입 공격(Brute-force)에 강하다.

---

#### 4. 양방향 암호화 — 대칭키 AES 예시

##### AES-256-CBC

```js
import crypto from 'crypto';

const key = crypto.randomBytes(32); // 256-bit key
const iv = crypto.randomBytes(16);

function encrypt(text) {
  const cipher = crypto.createCipheriv('aes-256-cbc', key, iv);
  let encrypted = cipher.update(text, 'utf8', 'hex');
  encrypted += cipher.final('hex');
  return encrypted;
}

function decrypt(encrypted) {
  const decipher = crypto.createDecipheriv('aes-256-cbc', key, iv);
  let decrypted = decipher.update(encrypted, 'hex', 'utf8');
  decrypted += decipher.final('utf8');
  return decrypted;
}

const encryptedText = encrypt('Hello Node.js');
console.log('암호화:', encryptedText);
console.log('복호화:', decrypt(encryptedText));
```

> AES는 고속·고보안 대칭키 알고리즘으로 HTTPS와 파일 암호화에도 활용된다.

---

#### 5. HTTPS / TLS 구성

HTTPS는 네트워크 구간에서 데이터를 암호화하여 중간자 공격(Man-in-the-Middle)을 방지한다.
Node.js에서는 `https` 모듈을 통해 직접 TLS 인증서를 사용할 수 있다.

##### 예시

```js
import https from 'https';
import fs from 'fs';
import express from 'express';

const app = express();

const options = {
  key: fs.readFileSync('certs/server.key'),
  cert: fs.readFileSync('certs/server.crt')
};

https.createServer(options, app).listen(443, () => {
  console.log('🔐 HTTPS 서버 실행 중');
});
```

> **인증서 발급**: Let's Encrypt(무료), DigiCert, Sectigo 등
> **테스트용**: `openssl req -x509 -newkey rsa:4096 -nodes -keyout key.pem -out cert.pem -days 365`

---

#### 6. Helmet을 통한 HTTP 헤더 보안

`helmet`은 Express/Fastify에서 보안 헤더를 자동으로 설정하는 미들웨어다.

##### 설치

```bash
$ npm install helmet
```

##### 사용

```js
import helmet from 'helmet';
app.use(helmet());
```

| 보호 항목                          | 설명              |
| ------------------------------ | --------------- |
| `X-Frame-Options`              | Clickjacking 방지 |
| `X-Content-Type-Options`       | MIME 스니핑 방지     |
| `Strict-Transport-Security`    | HTTPS 연결 강제     |
| `Cross-Origin-Resource-Policy` | CORS 정책 강화      |

---

#### 7. CORS 설정 (Cross-Origin Resource Sharing)

CORS는 브라우저가 다른 도메인의 리소스를 요청할 수 있도록 허용하는 보안 정책이다.

##### 설치 및 설정

```bash
$ npm install cors
```

```js
import cors from 'cors';
app.use(cors({
  origin: ['https://example.com'],
  credentials: true,
  methods: ['GET', 'POST', 'PUT', 'DELETE']
}));
```

> 💡 잘못된 CORS 설정은 API 키 유출 및 CSRF 공격으로 이어질 수 있으므로
> 허용 도메인을 반드시 제한해야 한다.

---

#### 8. 환경 변수 관리 (.env)

민감한 정보(API Key, DB Password)는 코드에 직접 작성하지 않고 `.env` 파일에 저장한다.

##### 설치

```bash
$ npm install dotenv
```

##### 예시

```bash
# .env
PORT=3000
JWT_SECRET=superSecretKey
DB_URL=mysql://user:pass@localhost:3306/db
```

```js
import 'dotenv/config';
console.log(process.env.DB_URL);
```

> `.env` 파일은 반드시 `.gitignore`에 추가해야 한다.
> 프로덕션 환경에서는 `process.env` 기반 Secret Manager(GCP, AWS, Vault 등)를 사용하는 것이 이상적이다.

---

#### 9. 의존성 취약점 점검

##### 보안 스캔

```bash
$ npm audit
$ npm audit fix
```

##### 자동 업데이트

```bash
$ npx npm-check-updates -u
$ npm install
```

> **의존성 관리 원칙**
>
> * 최소 권한 원칙 (Least Privilege)
> * 불필요한 패키지 제거
> * CVE(Critical Vulnerability) 즉시 업데이트

---

#### 10. Rate Limiter를 통한 요청 제한

DDoS 및 과도한 요청을 방지하기 위해 요청 빈도를 제한한다.

##### Express 예시

```js
import rateLimit from 'express-rate-limit';

const limiter = rateLimit({
  windowMs: 15 * 60 * 1000, // 15분
  max: 100, // 최대 100회 요청
  message: 'Too many requests, please try again later.',
});

app.use(limiter);
```

---

#### 11. 보안 강화 체크리스트

| 항목      | 설명                      | 도구/설정                  |
| ------- | ----------------------- | ---------------------- |
| 비밀번호 해시 | bcrypt / PBKDF2         | `bcrypt.hash()`        |
| 통신 암호화  | HTTPS / TLS             | `https.createServer()` |
| 환경변수 관리 | dotenv / Secret Manager | `.env`, Vault          |
| 입력 검증   | validator / Zod         | `express-validator`    |
| 헤더 보안   | Helmet                  | `app.use(helmet())`    |
| 취약점 점검  | npm audit               | `npm audit fix`        |
| 요청 제한   | Rate Limiter            | `express-rate-limit`   |

---

#### 12. 결론

Node.js 보안은 코드와 환경, 두 영역으로 나뉜다.
암호화·HTTPS·환경변수 관리·의존성 점검을 모두 통합해야 **실질적 보안 강화**가 가능하다.


