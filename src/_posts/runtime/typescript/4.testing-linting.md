---
title: "테스트 및 린팅 통합 (Type-Safe Testing & Linting)"
date: 2025-10-27
---

#### 요약
- TypeScript 프로젝트의 품질은 **정적 타입 검사(Type Checking)** 와 **런타임 테스트(Test Execution)**,  
  그리고 **코드 스타일 린팅(Linting)** 의 삼박자에 의해 유지된다.  
- 본 문서는 Jest, Vitest, ESLint, Prettier 등과 TypeScript의 통합 설정을 다루며,  
  **유형 안정성(Type Safety)** 과 **개발 효율성**을 동시에 확보하는 방법을 제시한다.  

**핵심 요약**
1. Jest와 Vitest는 모두 `ts-jest` 또는 `vite-tsconfig-paths` 플러그인으로 TS와 통합 가능하다.  
2. ESLint는 `@typescript-eslint` 플러그인 기반으로 TS 문법을 검사한다.  
3. Prettier는 코드 포맷팅 전용 도구로, Lint 규칙과 충돌되지 않게 별도 구성해야 한다.  
4. 테스트 코드(`*.test.ts`, `*.spec.ts`)도 타입 검사에 포함시키는 것이 이상적이다.  
5. 린팅은 코드 일관성과 버그 예방을 위한 **자동 품질 게이트** 역할을 한다.  

##### 참고자료
- [Jest + TypeScript 공식 가이드](https://kulshekhar.github.io/ts-jest/)
- [Vitest Docs](https://vitest.dev/guide/)
- [ESLint + TypeScript Plugin](https://typescript-eslint.io/)
- [Prettier Configuration Guide](https://prettier.io/docs/en/)

| 항목                   | 요약                        |
| -------------------- | ------------------------- |
| **Jest/Vitest 통합**   | 빠른 TS 테스트 환경 구성           |
| **ESLint + TS 플러그인** | 문법 규칙 및 오류 탐지             |
| **Prettier 연동**      | 코드 포맷 통일                  |
| **CI/CD 자동화**        | check → lint → test 순서 유지 |
| **type-safe 테스트**    | 컴파일 + 런타임 + 포맷 품질 통합      |

> 타입 기반 품질 관리의 완성은 “테스트”와 “린트”에서 이뤄진다.
> TypeScript 프로젝트는 이 세 단계를 통해
> **버그를 미리 예방하고, 코드의 일관성과 안정성을 확보한다.**
---

#### 1. Jest 통합 설정

> Node 및 React 환경에서 가장 널리 사용되는 테스트 러너

```bash
npm install --save-dev jest ts-jest @types/jest
```

```bash
npx ts-jest config:init
```

**jest.config.ts 예시**

```ts
import type { Config } from "jest";

const config: Config = {
  preset: "ts-jest",
  testEnvironment: "node",
  testMatch: ["**/?(*.)+(spec|test).[tj]s?(x)"],
  moduleNameMapper: {
    "^@src/(.*)$": "<rootDir>/src/$1"
  },
  clearMocks: true
};

export default config;
```

| 항목                 | 설명                |
| ------------------ | ----------------- |
| `preset`           | ts-jest 기반 트랜스파일  |
| `testEnvironment`  | Node / jsdom 등 선택 |
| `moduleNameMapper` | tsconfig 경로 별칭 매핑 |
| `testMatch`        | 테스트 파일 탐색 규칙      |

> 💡 Jest는 TypeScript 트랜스파일링 시 내부적으로 Babel 또는 ts-jest를 사용한다.

---

#### 2. Vitest 통합 설정

> Vite 기반 빌드 환경에서 가장 빠른 테스트 프레임워크

```bash
npm install --save-dev vitest @vitest/ui jsdom
```

**vite.config.ts 예시**

```ts
import { defineConfig } from "vitest/config";
import tsconfigPaths from "vite-tsconfig-paths";

export default defineConfig({
  plugins: [tsconfigPaths()],
  test: {
    globals: true,
    environment: "jsdom",
    include: ["src/**/*.test.ts"]
  }
});
```

| 특징        | 설명                                     |
| --------- | -------------------------------------- |
| 빠른 실행     | ESM 기반 빌드 + 캐시 사용                      |
| 경로 인식     | `vite-tsconfig-paths` 플러그인             |
| React 호환성 | `jsdom` 환경 설정으로 가능                     |
| Jest 호환성  | 동일한 API(`describe`, `it`, `expect`) 제공 |

> ⚙️ `Vitest`는 **Jest 대체제**로, `HMR(Hot Module Reload)`과 함께 실시간 테스트 피드백 제공

---

#### 3. 테스트 폴더 구조 권장

```
src/
 ├── components/
 │    ├── Button.tsx
 │    └── __tests__/Button.test.tsx
 ├── utils/
 │    ├── formatter.ts
 │    └── formatter.test.ts
 └── api/
      ├── user.ts
      └── user.spec.ts
```

| 원칙                      | 설명                           |
| ----------------------- | ---------------------------- |
| `__tests__` 디렉토리        | 모듈별 단위 테스트 그룹화               |
| `.test.ts` / `.spec.ts` | 파일 단위 명시적 구분                 |
| 공통 setup                | `/test/setup.ts` 에 초기 설정 모듈화 |

> 🎯 테스트는 코드의 **문서이자 사양(Spec)** 역할을 한다.

---

#### 4. ESLint + TypeScript 설정

> 정적 분석 기반으로 문법 오류와 스타일 문제를 탐지

```bash
npm install --save-dev eslint @typescript-eslint/parser @typescript-eslint/eslint-plugin
```

**.eslintrc.js 예시**

```js
module.exports = {
  parser: "@typescript-eslint/parser",
  extends: [
    "eslint:recommended",
    "plugin:@typescript-eslint/recommended",
    "plugin:prettier/recommended"
  ],
  plugins: ["@typescript-eslint"],
  parserOptions: {
    ecmaVersion: "latest",
    sourceType: "module"
  },
  rules: {
    "@typescript-eslint/no-unused-vars": ["warn"],
    "@typescript-eslint/explicit-function-return-type": "off",
    "@typescript-eslint/no-explicit-any": "warn"
  }
};
```

| 항목                            | 설명                          |
| ----------------------------- | --------------------------- |
| `@typescript-eslint/parser`   | TS 코드 분석을 위한 전용 파서          |
| `extends`                     | 기본 규칙 + TS 전용 + Prettier 연동 |
| `rules`                       | 프로젝트별 커스터마이징 가능             |
| `plugin:prettier/recommended` | 포맷팅 충돌 자동 해결                |

> 💡 ESLint는 타입 검사 도구가 아니므로, **tsc --noEmit** 병행으로 타입 검증을 완성한다.

---

#### 5. Prettier 통합

> 코드 포맷터로, ESLint와 역할이 다르다.
> (ESLint는 “규칙 위반 검사”, Prettier는 “코드 정렬 및 스타일 포맷”)

```bash
npm install --save-dev prettier eslint-config-prettier eslint-plugin-prettier
```

**.prettierrc.json 예시**

```json
{
  "semi": true,
  "singleQuote": true,
  "tabWidth": 2,
  "printWidth": 100,
  "trailingComma": "all",
  "arrowParens": "avoid"
}
```

| 옵션              | 설명           |
| --------------- | ------------ |
| `singleQuote`   | 작은따옴표 사용     |
| `printWidth`    | 줄바꿈 기준 길이    |
| `trailingComma` | 객체 끝 쉼표 처리   |
| `arrowParens`   | 화살표 함수 괄호 생략 |

> ⚙️ `eslint-config-prettier`는 두 도구의 충돌 규칙을 제거한다.

---

#### 6. ESLint + Prettier 병합 실행

```bash
# 코드 린팅
npx eslint "src/**/*.{ts,tsx}"

# 포맷 자동 수정
npx prettier --write "src/**/*.{ts,tsx}"
```

**package.json 예시**

```jsonc
{
  "scripts": {
    "lint": "eslint src --ext .ts,.tsx",
    "format": "prettier --write 'src/**/*.{ts,tsx}'",
    "test": "vitest run",
    "check": "tsc --noEmit && npm run lint"
  }
}
```

> 💡 **CI 환경에서는** `check` 명령어를 활용해 “빌드 전 타입 검사 + 린팅” 자동화 가능

---

#### 7. 테스트와 타입 안정성 결합

```ts
interface User {
  id: number;
  name: string;
}

function getUserName(user: User): string {
  return user.name;
}

test("사용자 이름 반환", () => {
  const result = getUserName({ id: 1, name: "Ingeun" });
  expect(result).toBe("Ingeun");
});
```

| 검증 단계         | 설명                |
| ------------- | ----------------- |
| Type Checking | 컴파일 시점에서 타입 오류 검증 |
| Unit Test     | 런타임 동작 검증         |
| Lint          | 코드 스타일 및 규칙 검증    |

> 🧩 세 검증 단계(Type → Lint → Test)는 서로 보완 관계이다.

---

#### 8. CI/CD 파이프라인 연동

```yaml
# .github/workflows/test.yml
name: CI

on: [push, pull_request]

jobs:
  build:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      - uses: actions/setup-node@v4
        with:
          node-version: 20
      - run: npm ci
      - run: npm run check
      - run: npm run test -- --run
```

| 단계                   | 역할             |
| -------------------- | -------------- |
| `check`              | 타입 + 린트 병합 검사  |
| `test`               | 단위 테스트 실행      |
| `actions/setup-node` | Node 버전 일관성 보장 |

> ⚙️ 모든 CI 단계에서 **타입 검사 → 린팅 → 테스트** 순서를 유지하면 오류 누락을 방지할 수 있다.

---

#### 9. 실무 팁: 테스트 안정성 강화

| 항목                    | 전략                              | 설명            |
| --------------------- | ------------------------------- | ------------- |
| **Mocking**           | `jest.mock()` / `vi.mock()`     | 외부 API 의존도 제거 |
| **Test Data Factory** | faker.js / test-data-bot        | 더미 데이터 일관성    |
| **Coverage Report**   | `--coverage` 옵션                 | 코드 커버리지 추적    |
| **TS Alias 경로**       | `tsconfig-paths/register`       | 테스트 시 경로 인식   |
| **type-only import**  | `import type { User } from ...` | 불필요한 번들 제외    |

> 🎯 테스트 코드도 “타입 안전성”을 유지해야 한다 — `as unknown` 사용은 최소화할 것.

---

