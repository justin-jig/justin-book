---
title: "런타임 성능 최적화 (Runtime Performance Optimization)"
date: 2025-10-23
---

#### 요약  
컨테이너 런타임 성능은 CPU, 메모리, I/O, 네트워크 효율성에 의해 결정된다.  
리소스 제약 설정과 이미지 최적화, 캐시·로그 관리 등을 통해  
운영 환경에서의 안정성과 응답 속도를 개선할 수 있다.  

**핵심 정리**
- `--cpus`, `--memory` 옵션으로 리소스 제한 설정  
- 불필요한 레이어와 패키지를 제거해 런타임 크기 최소화  
- 로그 및 캐시 관리를 통해 I/O 부하 감소  
- cgroup, OverlayFS 튜닝으로 시스템 레벨 성능 향상  

##### 참고자료
- [Docker Docs – Runtime metrics](https://docs.docker.com/config/containers/resource_constraints/)
- [Optimizing container performance](https://docs.docker.com/config/containers/runmetrics/)
- [OverlayFS and cgroups tuning](https://man7.org/linux/man-pages/man7/cgroups.7.html)

---

#### 1. 리소스 제한 설정

```bash
docker run -d --cpus="2.0" --memory="1g" myapp:latest
```

> CPU 및 메모리 상한을 설정하여 다른 컨테이너와의 자원 경합을 방지한다.

| 옵션              | 설명                    |
| :-------------- | :-------------------- |
| `--cpus`        | 컨테이너가 사용할 CPU 코어 수 제한 |
| `--memory`      | 메모리 사용 상한 설정          |
| `--memory-swap` | 스왑 사용량 제한             |
| `--cpu-shares`  | CPU 우선순위 조정           |

---

#### 2. 이미지 경량화

* Alpine, Slim 등 최소 베이스 이미지 사용
* 불필요한 패키지 및 로그 제거
* 멀티스테이지 빌드로 실행 파일만 포함

```dockerfile
FROM python:3.11-slim
COPY app.py .
CMD ["python", "app.py"]
```

> 경량화된 이미지일수록 런타임 초기화가 빠르다.

---

#### 3. 로그 및 캐시 관리

```bash
docker run -d --log-opt max-size=10m --log-opt max-file=3 nginx
```

> 로그 회전을 설정해 디스크 사용량 폭주를 방지한다.

---

#### 4. OverlayFS 튜닝

Docker는 OverlayFS를 사용해 이미지와 컨테이너 레이어를 병합한다.
`/var/lib/docker` 파티션은 **SSD** 디스크에 배치하는 것이 성능상 유리하다.

| 설정 항목          | 권장값                  |
| :------------- | :------------------- |
| 파일시스템          | `ext4` 또는 `xfs`      |
| I/O 스케줄러       | `none` 또는 `deadline` |
| Storage driver | `overlay2` (기본)      |

---

#### 5. cgroup 기반 자원 제어

Linux cgroup을 통해 컨테이너별 CPU/메모리/IO 사용량을 제어한다.

```bash
cat /sys/fs/cgroup/docker/<id>/cpu.stat
cat /sys/fs/cgroup/docker/<id>/memory.current
```

> 시스템 모니터링 도구(top, pidstat)와 병행해 분석한다.

---

