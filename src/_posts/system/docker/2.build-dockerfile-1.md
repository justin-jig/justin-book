---
title: "Dockerfile 기본 구조와 지시어 (1)"
date: 2025-10-23
---

#### 요약  
Dockerfile은 컨테이너 이미지를 정의하고 자동으로 빌드하기 위한 스크립트 파일이다.  
이미지의 구성과 동작 방식을 **지시어(Instruction)** 로 명확히 기록하여,  
동일한 환경을 여러 시스템에서 재현할 수 있게 한다.  

* Dockerfile은 이미지 생성의 핵심 구성요소이다.
* 각 지시어는 독립적인 레이어로 저장된다.
* 최적의 순서와 캐시 활용으로 빌드 시간을 단축할 수 있다.

**핵심 정리**
- Dockerfile은 이미지를 자동 생성하기 위한 **빌드 스크립트**이다.  
- 각 지시어는 이미지의 **레이어(layer)** 를 형성한다.  
- 빌드는 `docker build` 명령으로 수행된다.  
- 캐시와 순서가 빌드 효율에 큰 영향을 미친다.  

##### 참고자료
- [Docker Docs – Dockerfile reference](https://docs.docker.com/engine/reference/builder/)
- [Best practices for writing Dockerfiles](https://docs.docker.com/develop/develop-images/dockerfile_best-practices/)

---

#### 1. Dockerfile 개요
Dockerfile은 컨테이너 실행 환경을 코드로 정의하는 문서이다.  
빌드 과정에서 각 단계는 새로운 이미지 레이어를 생성한다.  
아래는 기본적인 Dockerfile의 구조 예시이다.

```dockerfile
FROM ubuntu:24.04
RUN apt update && apt install -y curl
COPY . /app
WORKDIR /app
CMD ["python3", "main.py"]
```

---

#### 2. 주요 지시어 요약

| 지시어       | 설명         | 예시                         |
| :-------- | :--------- | :------------------------- |
| `FROM`    | 베이스 이미지 지정 | `FROM ubuntu:24.04`        |
| `RUN`     | 명령 실행      | `RUN apt install -y nginx` |
| `COPY`    | 로컬 파일 복사   | `COPY . /app`              |
| `WORKDIR` | 작업 디렉터리 설정 | `WORKDIR /app`             |
| `EXPOSE`  | 서비스 포트 지정  | `EXPOSE 8080`              |
| `CMD`     | 기본 실행 명령   | `CMD ["npm", "start"]`     |
| `ENV`     | 환경변수 설정    | `ENV NODE_ENV=production`  |

> 각 지시어는 불변의 빌드 단계이며, 순서 변경 시 캐시가 무효화될 수 있다.

---

#### 3. 빌드 및 실행 예시

```bash
docker build -t myapp:1.0 .
docker run -d -p 8080:8080 myapp:1.0
```

> `-t` 옵션은 이미지 태그를 지정하며, `.` 은 현재 디렉터리를 빌드 컨텍스트로 사용한다.

---

#### 4. 베스트 프랙티스

* 불필요한 파일은 `.dockerignore`에 등록하여 빌드 효율 향상
* `apt install` 시 `--no-install-recommends` 옵션으로 용량 최소화
* 명령은 캐시를 고려해 **변경이 적은 순서대로 작성**
* 애플리케이션 실행 계정은 `USER` 지시어로 일반 사용자 지정

---



