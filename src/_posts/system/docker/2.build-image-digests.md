---
title: "Docker Digest와 버전 고정 전략 (2)"
date: 2025-10-23
---

#### 요약  
Docker 이미지는 태그뿐 아니라 **Digest(SHA256 해시)** 로도 고유하게 식별된다.  
Digest는 이미지의 **변경 불가능한 ID** 로, 버전 충돌이나 의도치 않은 업데이트를 방지한다.  

* Digest는 이미지의 “지문”이다.
* 운영 환경에서는 Digest 기반 고정 배포가 안전하다.
* 태그와 Digest를 병행하여 관리하는 것이 이상적이다.

**핵심 정리**
- Digest는 이미지 내용을 기반으로 생성된 고유 해시값이다.  
- 태그는 변경될 수 있지만 Digest는 불변이다.  
- 프로덕션 환경에서는 Digest 기반으로 배포 고정이 권장된다.  
- `docker inspect` 명령으로 Digest 값을 확인할 수 있다.  

##### 참고자료
- [Docker Docs – Image Digests](https://docs.docker.com/engine/reference/commandline/pull/#pull-an-image-by-digest)
- [OCI Specification – Content Addressability](https://github.com/opencontainers/image-spec)
- [Secure Supply Chain (Docker)](https://docs.docker.com/security/)

---

#### 1. Digest 개요

Docker 이미지가 빌드되면, 내부적으로 SHA256 해시값이 부여된다.  
이 해시는 이미지 내용이 조금이라도 변경되면 달라진다.

```bash
docker pull ubuntu@sha256:2e6e20
```

> Digest는 이미지의 **내용(Address)** 을 기반으로 한 유일한 식별자다.

---

#### 2. Digest 확인

```bash
docker inspect --format='{{index .RepoDigests 0}}' myapp:1.0.0
```

출력 예시:

```
registry.company.com/myapp@sha256:afc9d1f6b8e8c91b...
```

> 동일한 태그라도 Digest가 다르면 다른 이미지다.

---

#### 3. 버전 고정 전략

| 환경          | 권장 방식          | 예시                                  |
| :---------- | :------------- | :---------------------------------- |
| 개발 환경       | SemVer 기반 태그   | `myapp:1.2.3`                       |
| 운영 환경       | Digest 기반 배포   | `myapp@sha256:abcd...`              |
| CI/CD 파이프라인 | 태그 + Digest 병행 | `image: myapp:1.2.3@sha256:abcd...` |

---

#### 4. CI/CD 예시

```yaml
# GitLab CI 예시
deploy:
  image: docker:latest
  script:
    - docker pull registry.company.com/myapp@sha256:abcd1234
    - docker run -d registry.company.com/myapp@sha256:abcd1234
```

> Digest 기반 배포는 이미지 위변조 및 예기치 않은 업데이트를 방지한다.

---


