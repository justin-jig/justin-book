---
title: "빌드 성능 최적화 (Build Performance Optimization)"
date: 2025-10-23
---

#### 요약  
Docker 빌드 과정은 여러 레이어를 생성하고 캐시를 활용한다.  
효율적인 빌드 전략은 개발 속도와 CI/CD 파이프라인 성능에 직접적인 영향을 준다.  
`BuildKit`, `.dockerignore`, 멀티스테이지 빌드 등을 조합하면 빌드 시간을 크게 단축할 수 있다.  

* BuildKit + 멀티스테이지 빌드로 빌드 성능을 극대화한다.
* `.dockerignore`로 전송 크기를 줄이고 캐시 재활용을 최적화한다.
* 빌드 시간은 CI 메트릭으로 관리하여 성능 개선을 지속적으로 추적한다.

**핵심 정리**
- BuildKit 활성화로 빌드 병렬화 및 캐시 재활용 향상  
- `.dockerignore`로 불필요한 파일 제외  
- 멀티스테이지 빌드로 이미지 크기 최소화  
- `--cache-from` 옵션으로 이전 결과 재활용  

##### 참고자료
- [Docker BuildKit documentation](https://docs.docker.com/build/buildkit/)
- [Improving build performance](https://docs.docker.com/develop/dev-best-practices/)
- [Layer caching guide](https://docs.docker.com/build/cache/)

---

#### 1. BuildKit 활성화

```bash
export DOCKER_BUILDKIT=1
docker build -t myapp:latest .
```

> BuildKit은 병렬 빌드와 고급 캐싱을 지원하며, CI/CD 환경에서 필수적으로 사용된다.

---

#### 2. 캐시 재활용

이전 빌드 결과를 재활용하면 네트워크 다운로드 및 패키지 설치 시간을 줄일 수 있다.

```bash
docker build --cache-from myapp:latest -t myapp:new .
```

> `--cache-from` 옵션은 기존 레이어를 재활용해 불필요한 재빌드를 방지한다.

---

#### 3. .dockerignore 활용

```bash
node_modules
.git
__pycache__
.env
```

> `.dockerignore` 파일에 불필요한 디렉터리를 명시하면 빌드 컨텍스트 전송 속도가 향상된다.

---

#### 4. 멀티스테이지 빌드 적용

```dockerfile
FROM node:20 AS builder
WORKDIR /app
COPY . .
RUN npm install && npm run build

FROM nginx:alpine
COPY --from=builder /app/dist /usr/share/nginx/html
```

> 빌드 도구 및 의존성을 제외해 최종 이미지 크기를 최소화할 수 있다.

---

#### 5. 빌드 속도 측정

```bash
time docker build -t myapp:latest .
```

> CI/CD 환경에서는 평균 빌드 시간을 메트릭으로 수집하여 성능 개선 여부를 추적한다.

---

