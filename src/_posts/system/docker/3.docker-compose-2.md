---
title: "Docker Compose 확장 기능 (2) – Profiles와 환경변수"
date: 2025-10-23
---

#### 요약  
Compose는 **프로필(Profiles)** 과 **환경 변수(Variables)** 기능을 통해  
환경별 설정을 손쉽게 전환할 수 있다.  
이를 활용하면 동일한 Compose 파일로 개발/운영 환경을 분리할 수 있다.  

* `profiles` 로 환경별 선택 실행 가능
* `.env` 파일을 통한 변수 관리로 중복 설정 제거
* 다중 Compose 파일로 환경별 배포 구조를 구성할 수 있다.


**핵심 정리**
- `profiles` 속성으로 선택적 서비스 실행 가능  
- `.env` 파일을 통해 공통 환경 변수 관리  
- `COMPOSE_PROFILES` 환경 변수로 실행 그룹 지정  

##### 참고자료
- [Docker Docs – Compose profiles](https://docs.docker.com/compose/profiles/)
- [Compose Environment Variables](https://docs.docker.com/compose/environment-variables/)
- [Best practices for Compose files](https://docs.docker.com/compose/best-practices/)

---

#### 1. Profiles 예시
```yaml
version: "3.9"
services:
  web:
    image: nginx
    profiles: ["frontend"]
  db:
    image: postgres
    profiles: ["backend"]
```

```bash
# 프론트엔드만 실행
COMPOSE_PROFILES=frontend docker compose up -d
```

> 필요에 따라 특정 서비스 그룹만 선택적으로 실행 가능하다.

---

#### 2. 환경 변수 관리

##### 1) `.env` 파일 사용

```bash
POSTGRES_USER=admin
POSTGRES_PASSWORD=secret
```

##### 2) Compose 참조 방식

```yaml
environment:
  - POSTGRES_USER=${POSTGRES_USER}
  - POSTGRES_PASSWORD=${POSTGRES_PASSWORD}
```

> `.env` 파일은 Compose 실행 시 자동으로 읽힌다.

---

#### 3. 환경별 설정 분리

개발(`docker-compose.dev.yml`)과 운영(`docker-compose.prod.yml`) 파일을 분리할 수 있다.

```bash
docker compose -f docker-compose.prod.yml up -d
```

> 여러 파일을 병합(`-f`)하여 실행하면 환경 전환이 간편해진다.

---

