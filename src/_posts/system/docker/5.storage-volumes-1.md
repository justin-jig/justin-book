---
title: "Docker 스토리지와 볼륨 관리 (Storage and Volumes)"
date: 2025-10-23
---

#### 요약  
Docker 컨테이너는 기본적으로 휘발성 파일 시스템을 사용하므로,  
컨테이너 삭제 시 데이터도 함께 사라진다.  
이를 방지하기 위해 Docker는 **볼륨(Volume)** 과 **바인드 마운트(Bind Mount)** 방식을 제공하여  
데이터를 영구적으로 저장하거나 외부 디렉터리와 공유할 수 있다.  

* 볼륨은 컨테이너 데이터를 영속적으로 저장하는 기본 수단이다.
* 바인드 마운트는 호스트 디렉터리 공유에 적합하다.
* Compose와 NFS 드라이버를 활용하면 데이터 유지와 확장이 용이하다.

**핵심 정리**
- 컨테이너 데이터는 기본적으로 일시적이다.  
- **볼륨**은 Docker가 직접 관리하는 영속 스토리지이다.  
- **바인드 마운트**는 호스트 디렉터리를 직접 연결하는 방식이다.  
- `docker volume` 명령으로 볼륨을 생성·조회·삭제할 수 있다.  

##### 참고자료
- [Docker Docs – Manage data in containers](https://docs.docker.com/storage/)
- [Docker Volumes reference](https://docs.docker.com/storage/volumes/)
- [Bind Mounts overview](https://docs.docker.com/storage/bind-mounts/)

---

#### 1. 스토리지 옵션 개요

| 유형 | 설명 | 영속성 |
|:--|:--|:--|
| **Anonymous Volume** | 컨테이너 생성 시 자동 생성되는 볼륨 | 컨테이너 삭제 시 제거 가능 |
| **Named Volume** | 사용자가 직접 이름 지정하여 생성 | 영구 보존 |
| **Bind Mount** | 호스트 디렉터리를 직접 연결 | 외부 경로 그대로 사용 |

---

#### 2. 볼륨 명령어

| 명령어 | 설명 |
|:--|:--|
| `docker volume create mydata` | 새 볼륨 생성 |
| `docker volume ls` | 볼륨 목록 보기 |
| `docker volume inspect mydata` | 볼륨 상세 정보 |
| `docker volume rm mydata` | 볼륨 삭제 |

```bash
docker run -d -v mydata:/var/lib/mysql mysql:8
```
> `-v` 옵션으로 컨테이너 내부 경로(`/var/lib/mysql`)에 볼륨을 마운트한다.
---

#### 3. 바인드 마운트 예시

```bash
docker run -d \
  -v /home/user/appdata:/usr/src/app/data \
  myapp:latest
```

> 호스트의 `/home/user/appdata` 디렉터리를 컨테이너 내부와 직접 연결한다.

| 비교 항목 | Volume                    | Bind Mount  |
| :---- | :------------------------ | :---------- |
| 관리 주체 | Docker                    | 사용자         |
| 위치    | `/var/lib/docker/volumes` | 호스트 경로      |
| 접근성   | 자동 생성/삭제                  | 수동 관리       |
| 사용 예  | DB, 캐시, 로그 등              | 코드, 설정 파일 등 |

---

#### 4. Compose 기반 설정 예시

```yaml
services:
  db:
    image: postgres:15
    volumes:
      - dbdata:/var/lib/postgresql/data

volumes:
  dbdata:
```

> `volumes:` 블록에 정의하면 Compose가 자동으로 생성 및 관리한다.

---

#### 5. 드라이버 확장

Docker 볼륨은 플러그인 드라이버를 통해 NFS, CIFS, AWS EBS, GlusterFS 등 외부 스토리지와 연동 가능하다.

```bash
docker volume create \
  --driver local \
  --opt type=nfs \
  --opt o=addr=192.168.0.10,rw \
  --opt device=:/shared/data \
  nfsdata
```

> 클러스터 환경에서는 NFS나 Cloud Block Storage 연동이 일반적이다.

---
