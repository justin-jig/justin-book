---
title: "권한 최소화 전략 (2) – Read-only RootFS와 Seccomp"
date: 2025-10-23
---

#### 요약  
컨테이너는 애플리케이션의 실행만 담당해야 하므로,  
파일시스템과 시스템 호출(syscall)을 최소한으로 제한해야 한다.  
`--read-only` 옵션과 `seccomp` 프로파일을 이용하면  
런타임 권한을 안전하게 제어할 수 있다.  

* RootFS를 읽기 전용으로 설정해 불필요한 파일 수정 방지.
* seccomp로 커널 호출을 필터링하여 시스템 공격면 최소화.
* “불변 인프라 + 최소 권한”은 컨테이너 보안의 기본 조합이다.

**핵심 정리**
- `--read-only` 플래그로 루트 파일시스템을 읽기 전용으로 설정한다.  
- `seccomp` 프로파일로 허용된 시스템 호출만 실행하도록 제한한다.  
- 불변 인프라 원칙(Immutable Infrastructure)의 핵심이다.  

##### 참고자료
- [Docker Docs – Runtime security](https://docs.docker.com/engine/security/seccomp/)
- [Default seccomp profile](https://github.com/moby/moby/blob/master/profiles/seccomp/default.json)
- [Read-only root filesystem](https://docs.docker.com/config/containers/resource_constraints/#read-only)

---

#### 1. Read-only RootFS 예시
```bash
docker run -d --read-only -v /app/data:/data myapp:1.0
````

> 애플리케이션은 `/data` 경로에만 쓰기 가능하며, 나머지 루트 파일시스템은 읽기 전용이다.

---

#### 2. Seccomp 프로파일 적용

```bash
docker run -d \
  --security-opt seccomp=/etc/docker/seccomp/custom.json \
  nginx
```

> seccomp는 커널 수준의 시스템 호출 필터로,
> 허용된 호출만 수행할 수 있도록 제한한다.

---

#### 3. 커스텀 Seccomp 생성

```bash
cp /etc/docker/seccomp.json /etc/docker/seccomp/custom.json
vi /etc/docker/seccomp/custom.json
```

> 필요 없는 syscall을 제거하거나 허용 범위를 좁힌다.

---

#### 4. 보안 강화 조합 예시

```bash
docker run -d \
  --read-only \
  --cap-drop=ALL \
  --security-opt seccomp=default \
  --security-opt no-new-privileges:true \
  nginx
```

> 최소 권한 실행 원칙을 적용한 안전한 컨테이너 실행 예시이다.

---
