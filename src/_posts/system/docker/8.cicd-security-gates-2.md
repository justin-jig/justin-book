---
title: "승인형 파이프라인 구성 (Security Gates 2)"
date: 2025-10-23
---

#### 요약  
운영 환경 배포 전에는 사람이 직접 검토·승인해야 하는 경우가 있다.  
이를 위해 **Manual Approval** 단계를 CI/CD 파이프라인에 삽입하여  
중요 변경사항을 통제할 수 있다.  


* 승인 단계는 운영 환경 변경을 안전하게 통제한다.
* GitLab, GitHub 모두 수동 승인(Manual Approval)을 지원한다.
* 알림 시스템과 연계하여 DevOps 협업 효율성을 높일 수 있다.


**핵심 정리**
- 승인 대기 단계는 `manual`, `approval` 옵션으로 정의 가능.  
- 승인 전까지 배포 단계가 중단된다.  
- Slack, Teams 등의 알림 연동으로 협업 효율성을 높일 수 있다.  

##### 참고자료
- [GitLab CI Manual Jobs](https://docs.gitlab.com/ee/ci/yaml/#whenmanual)
- [GitHub Environments Approvals](https://docs.github.com/en/actions/deployment/targeting-different-environments/using-environments-for-deployment)
- [Jenkins Input Step Plugin](https://plugins.jenkins.io/input-step/)

---

#### 1. GitLab CI 예시
```yaml
stages:
  - build
  - deploy

deploy_production:
  stage: deploy
  script:
    - docker pull user/myapp:latest
    - docker run -d user/myapp:latest
  when: manual
  environment:
    name: production
```

> `when: manual` 로 설정된 단계는 사용자가 승인할 때까지 대기한다.

---

#### 2. GitHub Actions 환경 승인 예시

```yaml
deployment:
  runs-on: ubuntu-latest
  environment:
    name: production
    url: https://myapp.example.com
    reviewers:
      - ingeun
      - devops-team
```

> 지정된 승인자 중 한 명이 승인을 해야 배포가 진행된다.

---

#### 3. Slack 알림 연동

```yaml
- name: Notify Approval
  uses: slackapi/slack-github-action@v2
  with:
    payload: '{"text":"🚦 Production deploy waiting for approval"}'
```

> Slack 채널에서 승인 요청을 실시간으로 전달받을 수 있다.

---
